<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>集合类解析 | Kevin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="JAVA集合类详解">
<meta property="og:type" content="article">
<meta property="og:title" content="集合类解析">
<meta property="og:url" content="/2015/07/11/集合类解析/index.html">
<meta property="og:site_name" content="Kevin">
<meta property="og:description" content="JAVA集合类详解">
<meta property="og:image" content="http://img.blog.csdn.net/20150710085816164">
<meta property="og:image" content="http://img.blog.csdn.net/20150711103734904">
<meta property="og:updated_time" content="2016-07-19T03:55:17.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="集合类解析">
<meta name="twitter:description" content="JAVA集合类详解">
<meta name="twitter:image" content="http://img.blog.csdn.net/20150710085816164">
  
  
    <link rel="icon" href="/favicon.png">
  
  <!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'> -->
  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css"> -->
  <link href="//fonts.useso.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css">
  <link href='//fonts.useso.com/css?family=Open+Sans:300,600' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/style.css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <a href="/" class="logo">Kevin</a>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about/index.html">关于</a>
        
          <a class="main-nav-link" href="/atom.xml">RSS</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value=""></form>
        </div>
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
        
        
          <a id="nav-github-link" class="nav-icon" href="https://github.com/xiuweikang" title="Fork me on GitHub"></a>
        
      </nav>
    </div>
  </div>
</header>
      <nav id="mobile-nav" class="off">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about/index.html" class="mobile-nav-link">关于</a>
  
    <a href="/atom.xml" class="mobile-nav-link">RSS</a>
  
  <div id="search-form-wrap-mobile">
    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value=""></form>
  </div>
</nav>
      <div class="outer">
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/11/10/Build-Variants-Merge-Manifests/">AndroidManifests文件合并</a>
          </li>
        
          <li>
            <a href="/2016/11/07/shell学习/">shell学习</a>
          </li>
        
          <li>
            <a href="/2016/09/14/gradle学习/">gradle学习</a>
          </li>
        
          <li>
            <a href="/2016/09/01/工具类交流/">工具类交流</a>
          </li>
        
          <li>
            <a href="/2016/08/03/View基础相关/">View基础相关</a>
          </li>
        
          <li>
            <a href="/2016/08/03/Android动画详解/">Android动画详解</a>
          </li>
        
          <li>
            <a href="/2016/07/26/View的measure、layout、draw过程/">View的measure、layout、draw过程</a>
          </li>
        
          <li>
            <a href="/2016/07/08/effective-java学习笔记/">effective java学习笔记</a>
          </li>
        
          <li>
            <a href="/2016/05/15/git笔记/">git笔记</a>
          </li>
        
          <li>
            <a href="/2016/03/17/Retrofit分享/">Retrofit分享</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Gradle/" style="font-size: 10px;">Gradle</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Shell/" style="font-size: 10px;">Shell</a> <a href="/tags/TCP-IP/" style="font-size: 18.33px;">TCP/IP</a> <a href="/tags/java/" style="font-size: 13.33px;">java</a> <a href="/tags/数据结构/" style="font-size: 16.67px;">数据结构</a> <a href="/tags/源码解析/" style="font-size: 10px;">源码解析</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/设计模式/" style="font-size: 11.67px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">links</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://my.csdn.net/jiaomingliang">亮亮的博客</a>
          </li>
        
          <li>
            <a href="http://cheduzi.wang">二哥的博客</a>
          </li>
        
          <li>
            <a href="http://blog.csdn.net/guolin_blog">郭神的博客</a>
          </li>
        
          <li>
            <a href="http://http://blog.csdn.net/singwhatiwanna">任玉刚的博客</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
        <section id="main"><article id="post-集合类解析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/11/集合类解析/" class="article-date">
  <time datetime="2015-07-11T12:36:46.000Z" itemprop="datePublished">7月 11 2015</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      集合类解析
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="JAVA集合类详解"><a href="#JAVA集合类详解" class="headerlink" title="JAVA集合类详解"></a>JAVA集合类详解</h1><p><img src="http://img.blog.csdn.net/20150710085816164" alt="集合框架图"></p>
<h2 id=""><a href="#" class="headerlink" title=""></a><a id="more"></a></h2><h2 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h2><p>collection接口为JAVA所有集合类的根接口，代表容器。它为实现类提供了一些基本的操作，但是没有类直接对它实现，一般是对它进行接口扩展。然后定义一些骨干实现，从而减少工作量，例如<code>AbstractCollection</code>。</p>
<h2 id="Iterable"><a href="#Iterable" class="headerlink" title="Iterable"></a>Iterable</h2><p>Collection接口扩展了Iterable接口，所以所有的集合的实现类都必须实现<code>Iterator&lt;T&gt; iterator()</code>方法，返回一个迭代器对集合进行迭代。<br>除此之外<code>foreach</code>的本质就是通过迭代器来实现的，因此实现了Iterable接口的都可以foreach</p>
<p><strong>collection的主要子接口有三个，分别代表三种功能的容器  List Queue Set ,Map不是</strong></p>
<h2 id="List及其子类"><a href="#List及其子类" class="headerlink" title="List及其子类"></a>List及其子类</h2><p>List接口本身对Collection接口进行扩展，添加了<code>listIterator()</code>返回Iterator的子类<code>ListIterator</code>（可按任意方向遍历列表）</p>
<h3 id="AbstractList"><a href="#AbstractList" class="headerlink" title="AbstractList"></a>AbstractList</h3><p>继承<code>AbstractCollection</code>提供了List接口的骨干实现</p>
<ul>
<li><strong>Vector</strong>  最早的以数组实现的集合类，但是因为实现并发需要同步，而带来了性能的损失，因此基本上已经弃用，而它的子类<strong><code>Stack</code></strong>更是饱受诟病，是最早JDK的一个失误，之所以不去掉它或是重写只是为了兼容之前版本的项目，现在基本由LikedList实现</li>
<li>ArrayList 内部以数组实现，后面进行详细解释</li>
<li><p>AbstractSequentialList它的实现类只有LinkedList，可能在这里写一个骨干实现是为了之后的扩展。</p>
<p>###ListIterator<br>ListIterator 没有当前元素；它的光标位置 始终位于调用 previous() 所返回的元素和调用 next() 所返回的元素之间。在长度为 n 的列表中，有 n+1 个有效的索引值，从 0 到 n（包含）。 </p>
</li>
</ul>
<pre><code>  Element(0)   Element(1)   Element(2)   ... Element(n)   
^            ^            ^            ^               ^
</code></pre><p> Index: 0            1            2            3               n+1</p>
<h3 id="ArrayList源码分析"><a href="#ArrayList源码分析" class="headerlink" title="ArrayList源码分析"></a>ArrayList源码分析</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> java.util;  </div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt;  </span></div><div class="line">        <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">RandomAccess</span>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>  </div><div class="line">&#123;  </div><div class="line">    <span class="comment">// 序列版本号  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">8683452581122892189L</span>;  </div><div class="line"> </div><div class="line">    <span class="comment">// ArrayList基于该数组实现，用该数组保存数据 </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Object[] elementData;  </div><div class="line"> </div><div class="line">    <span class="comment">// ArrayList中实际数据的数量  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;  </div><div class="line"> </div><div class="line">    <span class="comment">// ArrayList带容量大小的构造函数。  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;  </div><div class="line">        <span class="keyword">super</span>();  </div><div class="line">        <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal Capacity: "</span>+  </div><div class="line">                                               initialCapacity);  </div><div class="line">        <span class="comment">// 新建一个数组  </span></div><div class="line">        <span class="keyword">this</span>.elementData = <span class="keyword">new</span> Object[initialCapacity];  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// ArrayList无参构造函数。默认容量是10。  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">this</span>(<span class="number">10</span>);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 创建一个包含collection的ArrayList  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;  </div><div class="line">        elementData = c.toArray();  </div><div class="line">        size = elementData.length;  </div><div class="line">        <span class="keyword">if</span> (elementData.getClass() != Object[].class)  </div><div class="line">            elementData = Arrays.copyOf(elementData, size, Object[].class);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// 将当前容量值设为实际元素个数  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">trimToSize</span><span class="params">()</span> </span>&#123;  </div><div class="line">        modCount++;  </div><div class="line">        <span class="keyword">int</span> oldCapacity = elementData.length;  </div><div class="line">        <span class="keyword">if</span> (size &lt; oldCapacity) &#123;  </div><div class="line">            elementData = Arrays.copyOf(elementData, size);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// 确定ArrarList的容量。  </span></div><div class="line">    <span class="comment">// 若ArrayList的容量不足以容纳当前的全部元素，设置 新的容量=“(原始容量x3)/2 + 1”  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 将“修改统计数”+1，该变量主要是用来实现fail-fast机制的  </span></div><div class="line">        modCount++;  </div><div class="line">        <span class="keyword">int</span> oldCapacity = elementData.length;  </div><div class="line">        <span class="comment">// 若当前容量不足以容纳当前的元素个数，设置 新的容量=“(原始容量x3)/2 + 1”  </span></div><div class="line">        <span class="keyword">if</span> (minCapacity &gt; oldCapacity) &#123;  </div><div class="line">            Object oldData[] = elementData;  </div><div class="line">            <span class="keyword">int</span> newCapacity = (oldCapacity * <span class="number">3</span>)/<span class="number">2</span> + <span class="number">1</span>;  </div><div class="line">			<span class="comment">//如果还不够，则直接将minCapacity设置为当前容量</span></div><div class="line">            <span class="keyword">if</span> (newCapacity &lt; minCapacity)  </div><div class="line">                newCapacity = minCapacity;  </div><div class="line">            elementData = Arrays.copyOf(elementData, newCapacity);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 添加元素e  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 确定ArrayList的容量大小  </span></div><div class="line">        ensureCapacity(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!  </span></div><div class="line">        <span class="comment">// 添加e到ArrayList中  </span></div><div class="line">        elementData[size++] = e;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回ArrayList的实际大小  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> size;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// ArrayList是否包含Object(o)  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> indexOf(o) &gt;= <span class="number">0</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">//返回ArrayList是否为空  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 正向查找，返回元素的索引值  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)  </div><div class="line">            <span class="keyword">if</span> (elementData[i]==<span class="keyword">null</span>)  </div><div class="line">                <span class="keyword">return</span> i;  </div><div class="line">            &#125; <span class="keyword">else</span> &#123;  </div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)  </div><div class="line">                <span class="keyword">if</span> (o.equals(elementData[i]))  </div><div class="line">                    <span class="keyword">return</span> i;  </div><div class="line">            &#125;  </div><div class="line">            <span class="keyword">return</span> -<span class="number">1</span>;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 反向查找，返回元素的索引值  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)  </div><div class="line">            <span class="keyword">if</span> (elementData[i]==<span class="keyword">null</span>)  </div><div class="line">                <span class="keyword">return</span> i;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)  </div><div class="line">            <span class="keyword">if</span> (o.equals(elementData[i]))  </div><div class="line">                <span class="keyword">return</span> i;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 反向查找(从数组末尾向开始查找)，返回元素(o)的索引值  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)  </div><div class="line">            <span class="keyword">if</span> (elementData[i]==<span class="keyword">null</span>)  </div><div class="line">                <span class="keyword">return</span> i;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = size-<span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)  </div><div class="line">            <span class="keyword">if</span> (o.equals(elementData[i]))  </div><div class="line">                <span class="keyword">return</span> i;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;  </div><div class="line">    &#125;  </div><div class="line">   </div><div class="line"> </div><div class="line">    <span class="comment">// 返回ArrayList的Object数组  </span></div><div class="line">    <span class="keyword">public</span> Object[] toArray() &#123;  </div><div class="line">        <span class="keyword">return</span> Arrays.copyOf(elementData, size);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回ArrayList元素组成的数组</span></div><div class="line">    <span class="keyword">public</span> &lt;T&gt; T[] toArray(T[] a) &#123;  </div><div class="line">        <span class="comment">// 若数组a的大小 &lt; ArrayList的元素个数；  </span></div><div class="line">        <span class="comment">// 则新建一个T[]数组，数组大小是“ArrayList的元素个数”，并将“ArrayList”全部拷贝到新数组中  </span></div><div class="line">        <span class="keyword">if</span> (a.length &lt; size)  </div><div class="line">            <span class="keyword">return</span> (T[]) Arrays.copyOf(elementData, size, a.getClass());  </div><div class="line"> </div><div class="line">        <span class="comment">// 若数组a的大小 &gt;= ArrayList的元素个数；  </span></div><div class="line">        <span class="comment">// 则将ArrayList的全部元素都拷贝到数组a中。  </span></div><div class="line">        System.arraycopy(elementData, <span class="number">0</span>, a, <span class="number">0</span>, size);  </div><div class="line">        <span class="keyword">if</span> (a.length &gt; size)  </div><div class="line">            a[size] = <span class="keyword">null</span>;  </div><div class="line">        <span class="keyword">return</span> a;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 获取index位置的元素值  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </div><div class="line">        RangeCheck(index);  </div><div class="line"> </div><div class="line">        <span class="keyword">return</span> (E) elementData[index];  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 设置index位置的值为element  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;  </div><div class="line">        RangeCheck(index);  </div><div class="line"> </div><div class="line">        E oldValue = (E) elementData[index];  </div><div class="line">        elementData[index] = element;  </div><div class="line">        <span class="keyword">return</span> oldValue;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将e添加到ArrayList中  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        ensureCapacity(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!  </span></div><div class="line">        elementData[size++] = e;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将e添加到ArrayList的指定位置  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (index &gt; size || index &lt; <span class="number">0</span>)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(  </div><div class="line">            <span class="string">"Index: "</span>+index+<span class="string">", Size: "</span>+size);  </div><div class="line"> </div><div class="line">        ensureCapacity(size+<span class="number">1</span>);  <span class="comment">// Increments modCount!!  </span></div><div class="line">        System.arraycopy(elementData, index, elementData, index + <span class="number">1</span>,  </div><div class="line">             size - index);  </div><div class="line">        elementData[index] = element;  </div><div class="line">        size++;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除ArrayList指定位置的元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </div><div class="line">        RangeCheck(index);  </div><div class="line"> </div><div class="line">        modCount++;  </div><div class="line">        E oldValue = (E) elementData[index];  </div><div class="line"> </div><div class="line">        <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;  </div><div class="line">        <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)  </div><div class="line">            System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,  </div><div class="line">                 numMoved);  </div><div class="line">        elementData[--size] = <span class="keyword">null</span>; <span class="comment">// Let gc do its work  </span></div><div class="line"> </div><div class="line">        <span class="keyword">return</span> oldValue;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除ArrayList的指定元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;  </div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)  </div><div class="line">            <span class="keyword">if</span> (elementData[index] == <span class="keyword">null</span>) &#123;  </div><div class="line">                fastRemove(index);  </div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)  </div><div class="line">            <span class="keyword">if</span> (o.equals(elementData[index])) &#123;  </div><div class="line">                fastRemove(index);  </div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// 快速删除第index个元素  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fastRemove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </div><div class="line">        modCount++;  </div><div class="line">        <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;  </div><div class="line">        <span class="comment">// 从"index+1"开始，用后面的元素替换前面的元素。  </span></div><div class="line">        <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)  </div><div class="line">            System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,  </div><div class="line">                             numMoved);  </div><div class="line">        <span class="comment">// 将最后一个元素设为null  </span></div><div class="line">        elementData[--size] = <span class="keyword">null</span>; <span class="comment">// Let gc do its work  </span></div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (o == <span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)  </div><div class="line">            <span class="keyword">if</span> (elementData[index] == <span class="keyword">null</span>) &#123;  </div><div class="line">                fastRemove(index);  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="comment">// 便利ArrayList，找到“元素o”，则删除，并返回true。  </span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; size; index++)  </div><div class="line">            <span class="keyword">if</span> (o.equals(elementData[index])) &#123;  </div><div class="line">                fastRemove(index);  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 清空ArrayList，将全部的元素设为null  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;  </div><div class="line">        modCount++;  </div><div class="line"> </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)  </div><div class="line">            elementData[i] = <span class="keyword">null</span>;  </div><div class="line"> </div><div class="line">        size = <span class="number">0</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将集合c追加到ArrayList中  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;  </div><div class="line">        Object[] a = c.toArray();  </div><div class="line">        <span class="keyword">int</span> numNew = a.length;  </div><div class="line">        ensureCapacity(size + numNew);  <span class="comment">// Increments modCount  </span></div><div class="line">        System.arraycopy(a, <span class="number">0</span>, elementData, size, numNew);  </div><div class="line">        size += numNew;  </div><div class="line">        <span class="keyword">return</span> numNew != <span class="number">0</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 从index位置开始，将集合c添加到ArrayList  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (index &gt; size || index &lt; <span class="number">0</span>)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(  </div><div class="line">            <span class="string">"Index: "</span> + index + <span class="string">", Size: "</span> + size);  </div><div class="line"> </div><div class="line">        Object[] a = c.toArray();  </div><div class="line">        <span class="keyword">int</span> numNew = a.length;  </div><div class="line">        ensureCapacity(size + numNew);  <span class="comment">// Increments modCount  </span></div><div class="line"> </div><div class="line">        <span class="keyword">int</span> numMoved = size - index;  </div><div class="line">        <span class="keyword">if</span> (numMoved &gt; <span class="number">0</span>)  </div><div class="line">            System.arraycopy(elementData, index, elementData, index + numNew,  </div><div class="line">                 numMoved);  </div><div class="line"> </div><div class="line">        System.arraycopy(a, <span class="number">0</span>, elementData, index, numNew);  </div><div class="line">        size += numNew;  </div><div class="line">        <span class="keyword">return</span> numNew != <span class="number">0</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除fromIndex到toIndex之间的全部元素。  </span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">removeRange</span><span class="params">(<span class="keyword">int</span> fromIndex, <span class="keyword">int</span> toIndex)</span> </span>&#123;  </div><div class="line">    modCount++;  </div><div class="line">    <span class="keyword">int</span> numMoved = size - toIndex;  </div><div class="line">        System.arraycopy(elementData, toIndex, elementData, fromIndex,  </div><div class="line">                         numMoved);  </div><div class="line"> </div><div class="line">    <span class="comment">// Let gc do its work  </span></div><div class="line">    <span class="keyword">int</span> newSize = size - (toIndex-fromIndex);  </div><div class="line">    <span class="keyword">while</span> (size != newSize)  </div><div class="line">        elementData[--size] = <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RangeCheck</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </div><div class="line">    <span class="keyword">if</span> (index &gt;= size)  </div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(  </div><div class="line">        <span class="string">"Index: "</span>+index+<span class="string">", Size: "</span>+size);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// 克隆函数  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">try</span> &#123;  </div><div class="line">            ArrayList&lt;E&gt; v = (ArrayList&lt;E&gt;) <span class="keyword">super</span>.clone();  </div><div class="line">            <span class="comment">// 将当前ArrayList的全部元素拷贝到v中  </span></div><div class="line">            v.elementData = Arrays.copyOf(elementData, size);  </div><div class="line">            v.modCount = <span class="number">0</span>;  </div><div class="line">            <span class="keyword">return</span> v;  </div><div class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;  </div><div class="line">            <span class="comment">// this shouldn't happen, since we are Cloneable  </span></div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InternalError();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// java.io.Serializable的写入函数  </span></div><div class="line">    <span class="comment">// 将ArrayList的“容量，所有的元素值”都写入到输出流中  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span>  </span></div><div class="line">        <span class="keyword">throws</span> java.io.IOException&#123;  </div><div class="line">    <span class="comment">// Write out element count, and any hidden stuff  </span></div><div class="line">    <span class="keyword">int</span> expectedModCount = modCount;  </div><div class="line">    s.defaultWriteObject();  </div><div class="line"> </div><div class="line">        <span class="comment">// 写入“数组的容量”  </span></div><div class="line">        s.writeInt(elementData.length);  </div><div class="line"> </div><div class="line">    <span class="comment">// 写入“数组的每一个元素”  </span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++)  </div><div class="line">            s.writeObject(elementData[i]);  </div><div class="line"> </div><div class="line">    <span class="keyword">if</span> (modCount != expectedModCount) &#123;  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// java.io.Serializable的读取函数：根据写入方式读出  </span></div><div class="line">    <span class="comment">// 先将ArrayList的“容量”读出，然后将“所有的元素值”读出  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span>  </span></div><div class="line">        <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException &#123;  </div><div class="line">        <span class="comment">// Read in size, and any hidden stuff  </span></div><div class="line">        s.defaultReadObject();  </div><div class="line"> </div><div class="line">        <span class="comment">// 从输入流中读取ArrayList的“容量”  </span></div><div class="line">        <span class="keyword">int</span> arrayLength = s.readInt();  </div><div class="line">        Object[] a = elementData = <span class="keyword">new</span> Object[arrayLength];  </div><div class="line"> </div><div class="line">        <span class="comment">// 从输入流中将“所有的元素值”读出  </span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++)  </div><div class="line">            a[i] = s.readObject();  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ArrayList的实现中大量地调用了Arrays.copyof()和System.arraycopy()方法。我们有必要对这两个方法的实现做下深入的了解。</p>
<p> 首先来看Arrays.copyof()方法。它有很多个重载的方法，但实现思路都是一样的，我们来看泛型版本的源码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T[] copyOf(T[] original, <span class="keyword">int</span> newLength) &#123;</div><div class="line">		        <span class="keyword">return</span> (T[]) copyOf(original, newLength, original.getClass());</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T,U&gt; T[] copyOf(U[] original, <span class="keyword">int</span> newLength, Class&lt;? extends T[]&gt; newType) &#123;</div><div class="line">    T[] copy = ((Object)newType == (Object)Object[].class)</div><div class="line">        ? (T[]) <span class="keyword">new</span> Object[newLength]</div><div class="line">        : (T[]) Array.newInstance(newType.getComponentType(), newLength);</div><div class="line">    System.arraycopy(original, <span class="number">0</span>, copy, <span class="number">0</span>,</div><div class="line">                     Math.min(original.length, newLength));</div><div class="line">    <span class="keyword">return</span> copy;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里可以很明显地看出，该方法实际上是在其内部又创建了一个长度为newlength的数组，调用System.arraycopy()方法，将原来数组中的元素复制到了新的数组中。</p>
<p> 下面来看System.arraycopy()方法。该方法被标记了native，调用了系统的C/C++代码，在JDK中是看不到的，但在openJDK中可以看到其源码。该函数实际上最终调用了C语言的memmove()函数，因此它可以保证同一个数组内元素的正确复制和移动，比一般的复制方法的实现效率要高很多，很适合用来批量处理数组。Java强烈推荐在复制大量数组元素时用该方法，以取得更高的效率。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div></pre></td><td class="code"><pre><div class="line">        final void checkForComodification() &#123;</div><div class="line">            if (modCount != expectedModCount)</div><div class="line">                throw new ConcurrentModificationException();</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">```	 </div><div class="line">	 同时应该注意的modcount这个变量，这个变量主要作用是针对Iterator的，当我们调用iterator()方法返回一个迭代器，之后对容器进行改变的操作，在调用迭代器进行迭代时，会报错。主要是防止并发情况下，对数据访问的不统一。</div><div class="line">###Vector源码解析</div><div class="line">```java</div><div class="line">package java.util;  </div><div class="line"> </div><div class="line">public class Vector&lt;E&gt;  </div><div class="line">    extends AbstractList&lt;E&gt;  </div><div class="line">    implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable  </div><div class="line">&#123;  </div><div class="line">     </div><div class="line">    // 保存Vector中数据的数组  </div><div class="line">    protected Object[] elementData;  </div><div class="line"> </div><div class="line">    // 实际数据的数量  </div><div class="line">    protected int elementCount;  </div><div class="line"> </div><div class="line">    // 容量增长系数  </div><div class="line">    protected int capacityIncrement;  </div><div class="line"> </div><div class="line">    // Vector的序列版本号  </div><div class="line">    private static final long serialVersionUID = -2767605614048989439L;  </div><div class="line"> </div><div class="line">    // Vector构造函数。默认容量是10。  </div><div class="line">    public Vector() &#123;  </div><div class="line">        this(10);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 指定Vector容量大小的构造函数  </div><div class="line">    public Vector(int initialCapacity) &#123;  </div><div class="line">        this(initialCapacity, 0);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 指定Vector"容量大小"和"增长系数"的构造函数  </div><div class="line">    public Vector(int initialCapacity, int capacityIncrement) &#123;  </div><div class="line">        super();  </div><div class="line">        if (initialCapacity &lt; 0)  </div><div class="line">            throw new IllegalArgumentException("Illegal Capacity: "+  </div><div class="line">                                               initialCapacity);  </div><div class="line">        // 新建一个数组，数组容量是initialCapacity  </div><div class="line">        this.elementData = new Object[initialCapacity];  </div><div class="line">        // 设置容量增长系数  </div><div class="line">        this.capacityIncrement = capacityIncrement;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 指定集合的Vector构造函数。  </div><div class="line">    public Vector(Collection&lt;? extends E&gt; c) &#123;  </div><div class="line">        // 获取“集合(c)”的数组，并将其赋值给elementData  </div><div class="line">        elementData = c.toArray();  </div><div class="line">        // 设置数组长度  </div><div class="line">        elementCount = elementData.length;  </div><div class="line">        // c.toArray might (incorrectly) not return Object[] (see 6260652)  </div><div class="line">        if (elementData.getClass() != Object[].class)  </div><div class="line">            elementData = Arrays.copyOf(elementData, elementCount, Object[].class);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 将数组Vector的全部元素都拷贝到数组anArray中  </div><div class="line">    public synchronized void copyInto(Object[] anArray) &#123;  </div><div class="line">        System.arraycopy(elementData, 0, anArray, 0, elementCount);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 将当前容量值设为 =实际元素个数  </div><div class="line">    public synchronized void trimToSize() &#123;  </div><div class="line">        modCount++;  </div><div class="line">        int oldCapacity = elementData.length;  </div><div class="line">        if (elementCount &lt; oldCapacity) &#123;  </div><div class="line">            elementData = Arrays.copyOf(elementData, elementCount);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 确认“Vector容量”的帮助函数  </div><div class="line">    private void ensureCapacityHelper(int minCapacity) &#123;  </div><div class="line">        int oldCapacity = elementData.length;  </div><div class="line">        // 当Vector的容量不足以容纳当前的全部元素，增加容量大小。  </div><div class="line">        // 若 容量增量系数&gt;0(即capacityIncrement&gt;0)，则将容量增大当capacityIncrement  </div><div class="line">        // 否则，将容量增大一倍。  </div><div class="line">        if (minCapacity &gt; oldCapacity) &#123;  </div><div class="line">            Object[] oldData = elementData;  </div><div class="line">            int newCapacity = (capacityIncrement &gt; 0) ?  </div><div class="line">                (oldCapacity + capacityIncrement) : (oldCapacity * 2);  </div><div class="line">            if (newCapacity &lt; minCapacity) &#123;  </div><div class="line">                newCapacity = minCapacity;  </div><div class="line">            &#125;  </div><div class="line">            elementData = Arrays.copyOf(elementData, newCapacity);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 确定Vector的容量。  </div><div class="line">    public synchronized void ensureCapacity(int minCapacity) &#123;  </div><div class="line">        // 将Vector的改变统计数+1  </div><div class="line">        modCount++;  </div><div class="line">        ensureCapacityHelper(minCapacity);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 设置容量值为 newSize  </div><div class="line">    public synchronized void setSize(int newSize) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        if (newSize &gt; elementCount) &#123;  </div><div class="line">            // 若 "newSize 大于 Vector容量"，则调整Vector的大小。  </div><div class="line">            ensureCapacityHelper(newSize);  </div><div class="line">        &#125; else &#123;  </div><div class="line">            // 若 "newSize 小于/等于 Vector容量"，则将newSize位置开始的元素都设置为null  </div><div class="line">            for (int i = newSize ; i &lt; elementCount ; i++) &#123;  </div><div class="line">                elementData[i] = null;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        elementCount = newSize;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回“Vector的总的容量”  </div><div class="line">    public synchronized int capacity() &#123;  </div><div class="line">        return elementData.length;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回“Vector的实际大小”，即Vector中元素个数  </div><div class="line">    public synchronized int size() &#123;  </div><div class="line">        return elementCount;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 判断Vector是否为空  </div><div class="line">    public synchronized boolean isEmpty() &#123;  </div><div class="line">        return elementCount == 0;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回“Vector中全部元素对应的Enumeration”  </div><div class="line">    public Enumeration&lt;E&gt; elements() &#123;  </div><div class="line">        // 通过匿名类实现Enumeration  </div><div class="line">        return new Enumeration&lt;E&gt;() &#123;  </div><div class="line">            int count = 0;  </div><div class="line"> </div><div class="line">            // 是否存在下一个元素  </div><div class="line">            public boolean hasMoreElements() &#123;  </div><div class="line">                return count &lt; elementCount;  </div><div class="line">            &#125;  </div><div class="line"> </div><div class="line">            // 获取下一个元素  </div><div class="line">            public E nextElement() &#123;  </div><div class="line">                synchronized (Vector.this) &#123;  </div><div class="line">                    if (count &lt; elementCount) &#123;  </div><div class="line">                        return (E)elementData[count++];  </div><div class="line">                    &#125;  </div><div class="line">                &#125;  </div><div class="line">                throw new NoSuchElementException("Vector Enumeration");  </div><div class="line">            &#125;  </div><div class="line">        &#125;;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回Vector中是否包含对象(o)  </div><div class="line">    public boolean contains(Object o) &#123;  </div><div class="line">        return indexOf(o, 0) &gt;= 0;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    // 从index位置开始向后查找元素(o)。  </div><div class="line">    // 若找到，则返回元素的索引值；否则，返回-1  </div><div class="line">    public synchronized int indexOf(Object o, int index) &#123;  </div><div class="line">        if (o == null) &#123;  </div><div class="line">            // 若查找元素为null，则正向找出null元素，并返回它对应的序号  </div><div class="line">            for (int i = index ; i &lt; elementCount ; i++)  </div><div class="line">            if (elementData[i]==null)  </div><div class="line">                return i;  </div><div class="line">        &#125; else &#123;  </div><div class="line">            // 若查找元素不为null，则正向找出该元素，并返回它对应的序号  </div><div class="line">            for (int i = index ; i &lt; elementCount ; i++)  </div><div class="line">            if (o.equals(elementData[i]))  </div><div class="line">                return i;  </div><div class="line">        &#125;  </div><div class="line">        return -1;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 查找并返回元素(o)在Vector中的索引值  </div><div class="line">    public int indexOf(Object o) &#123;  </div><div class="line">        return indexOf(o, 0);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 从后向前查找元素(o)。并返回元素的索引  </div><div class="line">    public synchronized int lastIndexOf(Object o) &#123;  </div><div class="line">        return lastIndexOf(o, elementCount-1);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 从后向前查找元素(o)。开始位置是从前向后的第index个数；  </div><div class="line">    // 若找到，则返回元素的“索引值”；否则，返回-1。  </div><div class="line">    public synchronized int lastIndexOf(Object o, int index) &#123;  </div><div class="line">        if (index &gt;= elementCount)  </div><div class="line">            throw new IndexOutOfBoundsException(index + " &gt;= "+ elementCount);  </div><div class="line"> </div><div class="line">        if (o == null) &#123;  </div><div class="line">            // 若查找元素为null，则反向找出null元素，并返回它对应的序号  </div><div class="line">            for (int i = index; i &gt;= 0; i--)  </div><div class="line">            if (elementData[i]==null)  </div><div class="line">                return i;  </div><div class="line">        &#125; else &#123;  </div><div class="line">            // 若查找元素不为null，则反向找出该元素，并返回它对应的序号  </div><div class="line">            for (int i = index; i &gt;= 0; i--)  </div><div class="line">            if (o.equals(elementData[i]))  </div><div class="line">                return i;  </div><div class="line">        &#125;  </div><div class="line">        return -1;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回Vector中index位置的元素。  </div><div class="line">    // 若index月结，则抛出异常  </div><div class="line">    public synchronized E elementAt(int index) &#123;  </div><div class="line">        if (index &gt;= elementCount) &#123;  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index + " &gt;= " + elementCount);  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        return (E)elementData[index];  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 获取Vector中的第一个元素。  </div><div class="line">    // 若失败，则抛出异常！  </div><div class="line">    public synchronized E firstElement() &#123;  </div><div class="line">        if (elementCount == 0) &#123;  </div><div class="line">            throw new NoSuchElementException();  </div><div class="line">        &#125;  </div><div class="line">        return (E)elementData[0];  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 获取Vector中的最后一个元素。  </div><div class="line">    // 若失败，则抛出异常！  </div><div class="line">    public synchronized E lastElement() &#123;  </div><div class="line">        if (elementCount == 0) &#123;  </div><div class="line">            throw new NoSuchElementException();  </div><div class="line">        &#125;  </div><div class="line">        return (E)elementData[elementCount - 1];  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 设置index位置的元素值为obj  </div><div class="line">    public synchronized void setElementAt(E obj, int index) &#123;  </div><div class="line">        if (index &gt;= elementCount) &#123;  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index + " &gt;= " +  </div><div class="line">                                 elementCount);  </div><div class="line">        &#125;  </div><div class="line">        elementData[index] = obj;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 删除index位置的元素  </div><div class="line">    public synchronized void removeElementAt(int index) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        if (index &gt;= elementCount) &#123;  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index + " &gt;= " +  </div><div class="line">                                 elementCount);  </div><div class="line">        &#125; else if (index &lt; 0) &#123;  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index);  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        int j = elementCount - index - 1;  </div><div class="line">        if (j &gt; 0) &#123;  </div><div class="line">            System.arraycopy(elementData, index + 1, elementData, index, j);  </div><div class="line">        &#125;  </div><div class="line">        elementCount--;  </div><div class="line">        elementData[elementCount] = null; /* to let gc do its work */ </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 在index位置处插入元素(obj)  </div><div class="line">    public synchronized void insertElementAt(E obj, int index) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        if (index &gt; elementCount) &#123;  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index  </div><div class="line">                                 + " &gt; " + elementCount);  </div><div class="line">        &#125;  </div><div class="line">        ensureCapacityHelper(elementCount + 1);  </div><div class="line">        System.arraycopy(elementData, index, elementData, index + 1, elementCount - index);  </div><div class="line">        elementData[index] = obj;  </div><div class="line">        elementCount++;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 将“元素obj”添加到Vector末尾  </div><div class="line">    public synchronized void addElement(E obj) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        ensureCapacityHelper(elementCount + 1);  </div><div class="line">        elementData[elementCount++] = obj;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 在Vector中查找并删除元素obj。  </div><div class="line">    // 成功的话，返回true；否则，返回false。  </div><div class="line">    public synchronized boolean removeElement(Object obj) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        int i = indexOf(obj);  </div><div class="line">        if (i &gt;= 0) &#123;  </div><div class="line">            removeElementAt(i);  </div><div class="line">            return true;  </div><div class="line">        &#125;  </div><div class="line">        return false;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 删除Vector中的全部元素  </div><div class="line">    public synchronized void removeAllElements() &#123;  </div><div class="line">        modCount++;  </div><div class="line">        // 将Vector中的全部元素设为null  </div><div class="line">        for (int i = 0; i &lt; elementCount; i++)  </div><div class="line">            elementData[i] = null;  </div><div class="line"> </div><div class="line">        elementCount = 0;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 克隆函数  </div><div class="line">    public synchronized Object clone() &#123;  </div><div class="line">        try &#123;  </div><div class="line">            Vector&lt;E&gt; v = (Vector&lt;E&gt;) super.clone();  </div><div class="line">            // 将当前Vector的全部元素拷贝到v中  </div><div class="line">            v.elementData = Arrays.copyOf(elementData, elementCount);  </div><div class="line">            v.modCount = 0;  </div><div class="line">            return v;  </div><div class="line">        &#125; catch (CloneNotSupportedException e) &#123;  </div><div class="line">            // this shouldn't happen, since we are Cloneable  </div><div class="line">            throw new InternalError();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回Object数组  </div><div class="line">    public synchronized Object[] toArray() &#123;  </div><div class="line">        return Arrays.copyOf(elementData, elementCount);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回Vector的模板数组。所谓模板数组，即可以将T设为任意的数据类型  </div><div class="line">    public synchronized &lt;T&gt; T[] toArray(T[] a) &#123;  </div><div class="line">        // 若数组a的大小 &lt; Vector的元素个数；  </div><div class="line">        // 则新建一个T[]数组，数组大小是“Vector的元素个数”，并将“Vector”全部拷贝到新数组中  </div><div class="line">        if (a.length &lt; elementCount)  </div><div class="line">            return (T[]) Arrays.copyOf(elementData, elementCount, a.getClass());  </div><div class="line"> </div><div class="line">        // 若数组a的大小 &gt;= Vector的元素个数；  </div><div class="line">        // 则将Vector的全部元素都拷贝到数组a中。  </div><div class="line">    System.arraycopy(elementData, 0, a, 0, elementCount);  </div><div class="line"> </div><div class="line">        if (a.length &gt; elementCount)  </div><div class="line">            a[elementCount] = null;  </div><div class="line"> </div><div class="line">        return a;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 获取index位置的元素  </div><div class="line">    public synchronized E get(int index) &#123;  </div><div class="line">        if (index &gt;= elementCount)  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index);  </div><div class="line"> </div><div class="line">        return (E)elementData[index];  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 设置index位置的值为element。并返回index位置的原始值  </div><div class="line">    public synchronized E set(int index, E element) &#123;  </div><div class="line">        if (index &gt;= elementCount)  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index);  </div><div class="line"> </div><div class="line">        Object oldValue = elementData[index];  </div><div class="line">        elementData[index] = element;  </div><div class="line">        return (E)oldValue;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 将“元素e”添加到Vector最后。  </div><div class="line">    public synchronized boolean add(E e) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        ensureCapacityHelper(elementCount + 1);  </div><div class="line">        elementData[elementCount++] = e;  </div><div class="line">        return true;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 删除Vector中的元素o  </div><div class="line">    public boolean remove(Object o) &#123;  </div><div class="line">        return removeElement(o);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 在index位置添加元素element  </div><div class="line">    public void add(int index, E element) &#123;  </div><div class="line">        insertElementAt(element, index);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 删除index位置的元素，并返回index位置的原始值  </div><div class="line">    public synchronized E remove(int index) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        if (index &gt;= elementCount)  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index);  </div><div class="line">        Object oldValue = elementData[index];  </div><div class="line"> </div><div class="line">        int numMoved = elementCount - index - 1;  </div><div class="line">        if (numMoved &gt; 0)  </div><div class="line">            System.arraycopy(elementData, index+1, elementData, index,  </div><div class="line">                     numMoved);  </div><div class="line">        elementData[--elementCount] = null; // Let gc do its work  </div><div class="line"> </div><div class="line">        return (E)oldValue;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 清空Vector  </div><div class="line">    public void clear() &#123;  </div><div class="line">        removeAllElements();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回Vector是否包含集合c  </div><div class="line">    public synchronized boolean containsAll(Collection&lt;?&gt; c) &#123;  </div><div class="line">        return super.containsAll(c);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 将集合c添加到Vector中  </div><div class="line">    public synchronized boolean addAll(Collection&lt;? extends E&gt; c) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        Object[] a = c.toArray();  </div><div class="line">        int numNew = a.length;  </div><div class="line">        ensureCapacityHelper(elementCount + numNew);  </div><div class="line">        // 将集合c的全部元素拷贝到数组elementData中  </div><div class="line">        System.arraycopy(a, 0, elementData, elementCount, numNew);  </div><div class="line">        elementCount += numNew;  </div><div class="line">        return numNew != 0;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 删除集合c的全部元素  </div><div class="line">    public synchronized boolean removeAll(Collection&lt;?&gt; c) &#123;  </div><div class="line">        return super.removeAll(c);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 删除“非集合c中的元素”  </div><div class="line">    public synchronized boolean retainAll(Collection&lt;?&gt; c)  &#123;  </div><div class="line">        return super.retainAll(c);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 从index位置开始，将集合c添加到Vector中  </div><div class="line">    public synchronized boolean addAll(int index, Collection&lt;? extends E&gt; c) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        if (index &lt; 0 || index &gt; elementCount)  </div><div class="line">            throw new ArrayIndexOutOfBoundsException(index);  </div><div class="line"> </div><div class="line">        Object[] a = c.toArray();  </div><div class="line">        int numNew = a.length;  </div><div class="line">        ensureCapacityHelper(elementCount + numNew);  </div><div class="line"> </div><div class="line">        int numMoved = elementCount - index;  </div><div class="line">        if (numMoved &gt; 0)  </div><div class="line">        System.arraycopy(elementData, index, elementData, index + numNew, numMoved);  </div><div class="line"> </div><div class="line">        System.arraycopy(a, 0, elementData, index, numNew);  </div><div class="line">        elementCount += numNew;  </div><div class="line">        return numNew != 0;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 返回两个对象是否相等  </div><div class="line">    public synchronized boolean equals(Object o) &#123;  </div><div class="line">        return super.equals(o);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 计算哈希值  </div><div class="line">    public synchronized int hashCode() &#123;  </div><div class="line">        return super.hashCode();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 调用父类的toString()  </div><div class="line">    public synchronized String toString() &#123;  </div><div class="line">        return super.toString();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 获取Vector中fromIndex(包括)到toIndex(不包括)的子集  </div><div class="line">    public synchronized List&lt;E&gt; subList(int fromIndex, int toIndex) &#123;  </div><div class="line">        return Collections.synchronizedList(super.subList(fromIndex, toIndex), this);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // 删除Vector中fromIndex到toIndex的元素  </div><div class="line">    protected synchronized void removeRange(int fromIndex, int toIndex) &#123;  </div><div class="line">        modCount++;  </div><div class="line">        int numMoved = elementCount - toIndex;  </div><div class="line">        System.arraycopy(elementData, toIndex, elementData, fromIndex,  </div><div class="line">                         numMoved);  </div><div class="line"> </div><div class="line">        // Let gc do its work  </div><div class="line">        int newElementCount = elementCount - (toIndex-fromIndex);  </div><div class="line">        while (elementCount != newElementCount)  </div><div class="line">            elementData[--elementCount] = null;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    // java.io.Serializable的写入函数  </div><div class="line">    private synchronized void writeObject(java.io.ObjectOutputStream s)  </div><div class="line">        throws java.io.IOException &#123;  </div><div class="line">        s.defaultWriteObject();  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们可以看到Vector的许多方法添加synchronized同步语句，来保证线程安全，因此导致单线程中性能较低，而多线程情况下多用CopyOnWriteArrayList，因此Vector现在基本很少用了。</p>
<p>###LinkedList源码<br>    LinkedList是基于双向循环链表（从源码中可以很容易看出）实现的，除了可以当做链表来操作外，它还可以当做栈、队列和双端队列来使用。</p>
<pre><code>LinkedList实现了Serializable接口，因此它支持序列化，能够通过序列化传输，实现了Cloneable接口，能被克隆。
</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> java.util;  </div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedList</span>&lt;<span class="title">E</span>&gt;  </span></div><div class="line">    <span class="keyword">extends</span> <span class="title">AbstractSequentialList</span>&lt;<span class="title">E</span>&gt;  </div><div class="line">    <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">Deque</span>&lt;<span class="title">E</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>  </div><div class="line">&#123;  </div><div class="line">    <span class="comment">// 链表的表头，表头不包含任何数据。Entry是个链表类数据结构。  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;E&gt; header = <span class="keyword">new</span> Entry&lt;E&gt;(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);  </div><div class="line"> </div><div class="line">    <span class="comment">// LinkedList中元素个数  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">int</span> size = <span class="number">0</span>;  </div><div class="line"> </div><div class="line">    <span class="comment">// 默认构造函数：创建一个空的链表  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LinkedList</span><span class="params">()</span> </span>&#123;  </div><div class="line">        header.next = header.previous = header;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 包含“集合”的构造函数:创建一个包含“集合”的LinkedList  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LinkedList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;  </div><div class="line">        <span class="keyword">this</span>();  </div><div class="line">        addAll(c);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 获取LinkedList的第一个元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">getFirst</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (size==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();  </div><div class="line"> </div><div class="line">        <span class="comment">// 链表的表头header中不包含数据。  </span></div><div class="line">        <span class="comment">// 这里返回header所指下一个节点所包含的数据。  </span></div><div class="line">        <span class="keyword">return</span> header.next.element;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 获取LinkedList的最后一个元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">getLast</span><span class="params">()</span>  </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (size==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();  </div><div class="line"> </div><div class="line">        <span class="comment">// 由于LinkedList是双向链表；而表头header不包含数据。  </span></div><div class="line">        <span class="comment">// 因而，这里返回表头header的前一个节点所包含的数据。  </span></div><div class="line">        <span class="keyword">return</span> header.previous.element;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除LinkedList的第一个元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">removeFirst</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> remove(header.next);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除LinkedList的最后一个元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">removeLast</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> remove(header.previous);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将元素添加到LinkedList的起始位置  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addFirst</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        addBefore(e, header.next);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将元素添加到LinkedList的结束位置  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addLast</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        addBefore(e, header);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 判断LinkedList是否包含元素(o)  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> indexOf(o) != -<span class="number">1</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回LinkedList的大小  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> size;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将元素(E)添加到LinkedList中  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 将节点(节点数据是e)添加到表头(header)之前。  </span></div><div class="line">        <span class="comment">// 即，将节点添加到双向链表的末端。  </span></div><div class="line">        addBefore(e, header);  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 从LinkedList中删除元素(o)  </span></div><div class="line">    <span class="comment">// 从链表开始查找，如存在元素(o)则删除该元素并返回true；  </span></div><div class="line">    <span class="comment">// 否则，返回false。  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (o==<span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="comment">// 若o为null的删除情况  </span></div><div class="line">            <span class="keyword">for</span> (Entry&lt;E&gt; e = header.next; e != header; e = e.next) &#123;  </div><div class="line">                <span class="keyword">if</span> (e.element==<span class="keyword">null</span>) &#123;  </div><div class="line">                    remove(e);  </div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="comment">// 若o不为null的删除情况  </span></div><div class="line">            <span class="keyword">for</span> (Entry&lt;E&gt; e = header.next; e != header; e = e.next) &#123;  </div><div class="line">                <span class="keyword">if</span> (o.equals(e.element)) &#123;  </div><div class="line">                    remove(e);  </div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将“集合(c)”添加到LinkedList中。  </span></div><div class="line">    <span class="comment">// 实际上，是从双向链表的末尾开始，将“集合(c)”添加到双向链表中。  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(Collection&lt;? extends E&gt; c)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> addAll(size, c);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 从双向链表的index开始，将“集合(c)”添加到双向链表中。  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addAll</span><span class="params">(<span class="keyword">int</span> index, Collection&lt;? extends E&gt; c)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; size)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"Index: "</span>+index+  </div><div class="line">                                                <span class="string">", Size: "</span>+size);  </div><div class="line">        Object[] a = c.toArray();  </div><div class="line">        <span class="comment">// 获取集合的长度  </span></div><div class="line">        <span class="keyword">int</span> numNew = a.length;  </div><div class="line">        <span class="keyword">if</span> (numNew==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">        modCount++;  </div><div class="line"> </div><div class="line">        <span class="comment">// 设置“当前要插入节点的后一个节点”  </span></div><div class="line">        Entry&lt;E&gt; successor = (index==size ? header : entry(index));  </div><div class="line">        <span class="comment">// 设置“当前要插入节点的前一个节点”  </span></div><div class="line">        Entry&lt;E&gt; predecessor = successor.previous;  </div><div class="line">        <span class="comment">// 将集合(c)全部插入双向链表中  </span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;numNew; i++) &#123;  </div><div class="line">            Entry&lt;E&gt; e = <span class="keyword">new</span> Entry&lt;E&gt;((E)a[i], successor, predecessor);  </div><div class="line">            predecessor.next = e;  </div><div class="line">            predecessor = e;  </div><div class="line">        &#125;  </div><div class="line">        successor.previous = predecessor;  </div><div class="line"> </div><div class="line">        <span class="comment">// 调整LinkedList的实际大小  </span></div><div class="line">        size += numNew;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 清空双向链表  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;  </div><div class="line">        Entry&lt;E&gt; e = header.next;  </div><div class="line">        <span class="comment">// 从表头开始，逐个向后遍历；对遍历到的节点执行一下操作：  </span></div><div class="line">        <span class="comment">// (01) 设置前一个节点为null   </span></div><div class="line">        <span class="comment">// (02) 设置当前节点的内容为null   </span></div><div class="line">        <span class="comment">// (03) 设置后一个节点为“新的当前节点”  </span></div><div class="line">        <span class="keyword">while</span> (e != header) &#123;  </div><div class="line">            Entry&lt;E&gt; next = e.next;  </div><div class="line">            e.next = e.previous = <span class="keyword">null</span>;  </div><div class="line">            e.element = <span class="keyword">null</span>;  </div><div class="line">            e = next;  </div><div class="line">        &#125;  </div><div class="line">        header.next = header.previous = header;  </div><div class="line">        <span class="comment">// 设置大小为0  </span></div><div class="line">        size = <span class="number">0</span>;  </div><div class="line">        modCount++;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回LinkedList指定位置的元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> entry(index).element;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 设置index位置对应的节点的值为element  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;  </div><div class="line">        Entry&lt;E&gt; e = entry(index);  </div><div class="line">        E oldVal = e.element;  </div><div class="line">        e.element = element;  </div><div class="line">        <span class="keyword">return</span> oldVal;  </div><div class="line">    &#125;  </div><div class="line">   </div><div class="line">    <span class="comment">// 在index前添加节点，且节点的值为element  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;  </div><div class="line">        addBefore(element, (index==size ? header : entry(index)));  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除index位置的节点  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> remove(entry(index));  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 获取双向链表中指定位置的节点  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> Entry&lt;E&gt; <span class="title">entry</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= size)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"Index: "</span>+index+  </div><div class="line">                                                <span class="string">", Size: "</span>+size);  </div><div class="line">        Entry&lt;E&gt; e = header;  </div><div class="line">        <span class="comment">// 获取index处的节点。  </span></div><div class="line">        <span class="comment">// 若index &lt; 双向链表长度的1/2,则从前先后查找;  </span></div><div class="line">        <span class="comment">// 否则，从后向前查找。  </span></div><div class="line">        <span class="keyword">if</span> (index &lt; (size &gt;&gt; <span class="number">1</span>)) &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= index; i++)  </div><div class="line">                e = e.next;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = size; i &gt; index; i--)  </div><div class="line">                e = e.previous;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> e;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 从前向后查找，返回“值为对象(o)的节点对应的索引”  </span></div><div class="line">    <span class="comment">// 不存在就返回-1  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;  </div><div class="line">        <span class="keyword">if</span> (o==<span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="keyword">for</span> (Entry e = header.next; e != header; e = e.next) &#123;  </div><div class="line">                <span class="keyword">if</span> (e.element==<span class="keyword">null</span>)  </div><div class="line">                    <span class="keyword">return</span> index;  </div><div class="line">                index++;  </div><div class="line">            &#125;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="keyword">for</span> (Entry e = header.next; e != header; e = e.next) &#123;  </div><div class="line">                <span class="keyword">if</span> (o.equals(e.element))  </div><div class="line">                    <span class="keyword">return</span> index;  </div><div class="line">                index++;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 从后向前查找，返回“值为对象(o)的节点对应的索引”  </span></div><div class="line">    <span class="comment">// 不存在就返回-1  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">int</span> index = size;  </div><div class="line">        <span class="keyword">if</span> (o==<span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="keyword">for</span> (Entry e = header.previous; e != header; e = e.previous) &#123;  </div><div class="line">                index--;  </div><div class="line">                <span class="keyword">if</span> (e.element==<span class="keyword">null</span>)  </div><div class="line">                    <span class="keyword">return</span> index;  </div><div class="line">            &#125;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="keyword">for</span> (Entry e = header.previous; e != header; e = e.previous) &#123;  </div><div class="line">                index--;  </div><div class="line">                <span class="keyword">if</span> (o.equals(e.element))  </div><div class="line">                    <span class="keyword">return</span> index;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回第一个节点  </span></div><div class="line">    <span class="comment">// 若LinkedList的大小为0,则返回null  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">peek</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (size==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">        <span class="keyword">return</span> getFirst();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回第一个节点  </span></div><div class="line">    <span class="comment">// 若LinkedList的大小为0,则抛出异常  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">element</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> getFirst();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除并返回第一个节点  </span></div><div class="line">    <span class="comment">// 若LinkedList的大小为0,则返回null  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">poll</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (size==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">        <span class="keyword">return</span> removeFirst();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将e添加双向链表末尾  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">offer</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> add(e);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将e添加双向链表开头  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">offerFirst</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        addFirst(e);  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将e添加双向链表末尾  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">offerLast</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        addLast(e);  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回第一个节点  </span></div><div class="line">    <span class="comment">// 若LinkedList的大小为0,则返回null  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">peekFirst</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (size==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">        <span class="keyword">return</span> getFirst();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回最后一个节点  </span></div><div class="line">    <span class="comment">// 若LinkedList的大小为0,则返回null  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">peekLast</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (size==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">        <span class="keyword">return</span> getLast();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除并返回第一个节点  </span></div><div class="line">    <span class="comment">// 若LinkedList的大小为0,则返回null  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">pollFirst</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (size==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">        <span class="keyword">return</span> removeFirst();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除并返回最后一个节点  </span></div><div class="line">    <span class="comment">// 若LinkedList的大小为0,则返回null  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">pollLast</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (size==<span class="number">0</span>)  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">        <span class="keyword">return</span> removeLast();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将e插入到双向链表开头  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">        addFirst(e);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除并返回第一个节点  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">pop</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> removeFirst();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 从LinkedList开始向后查找，删除第一个值为元素(o)的节点  </span></div><div class="line">    <span class="comment">// 从链表开始查找，如存在节点的值为元素(o)的节点，则删除该节点  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeFirstOccurrence</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> remove(o);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 从LinkedList末尾向前查找，删除第一个值为元素(o)的节点  </span></div><div class="line">    <span class="comment">// 从链表开始查找，如存在节点的值为元素(o)的节点，则删除该节点  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeLastOccurrence</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (o==<span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="keyword">for</span> (Entry&lt;E&gt; e = header.previous; e != header; e = e.previous) &#123;  </div><div class="line">                <span class="keyword">if</span> (e.element==<span class="keyword">null</span>) &#123;  </div><div class="line">                    remove(e);  </div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">        &#125; <span class="keyword">else</span> &#123;  </div><div class="line">            <span class="keyword">for</span> (Entry&lt;E&gt; e = header.previous; e != header; e = e.previous) &#123;  </div><div class="line">                <span class="keyword">if</span> (o.equals(e.element)) &#123;  </div><div class="line">                    remove(e);  </div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回“index到末尾的全部节点”对应的ListIterator对象(List迭代器)  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> ListIterator&lt;E&gt; <span class="title">listIterator</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ListItr(index);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// List迭代器  </span></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ListItr</span> <span class="keyword">implements</span> <span class="title">ListIterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;  </div><div class="line">        <span class="comment">// 上一次返回的节点  </span></div><div class="line">        <span class="keyword">private</span> Entry&lt;E&gt; lastReturned = header;  </div><div class="line">        <span class="comment">// 下一个节点  </span></div><div class="line">        <span class="keyword">private</span> Entry&lt;E&gt; next;  </div><div class="line">        <span class="comment">// 下一个节点对应的索引值  </span></div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> nextIndex;  </div><div class="line">        <span class="comment">// 期望的改变计数。用来实现fail-fast机制。  </span></div><div class="line">        <span class="keyword">private</span> <span class="keyword">int</span> expectedModCount = modCount;  </div><div class="line"> </div><div class="line">        <span class="comment">// 构造函数。  </span></div><div class="line">        <span class="comment">// 从index位置开始进行迭代  </span></div><div class="line">        ListItr(<span class="keyword">int</span> index) &#123;  </div><div class="line">            <span class="comment">// index的有效性处理  </span></div><div class="line">            <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; size)  </div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">"Index: "</span>+index+ <span class="string">", Size: "</span>+size);  </div><div class="line">            <span class="comment">// 若 “index 小于 ‘双向链表长度的一半’”，则从第一个元素开始往后查找；  </span></div><div class="line">            <span class="comment">// 否则，从最后一个元素往前查找。  </span></div><div class="line">            <span class="keyword">if</span> (index &lt; (size &gt;&gt; <span class="number">1</span>)) &#123;  </div><div class="line">                next = header.next;  </div><div class="line">                <span class="keyword">for</span> (nextIndex=<span class="number">0</span>; nextIndex&lt;index; nextIndex++)  </div><div class="line">                    next = next.next;  </div><div class="line">            &#125; <span class="keyword">else</span> &#123;  </div><div class="line">                next = header;  </div><div class="line">                <span class="keyword">for</span> (nextIndex=size; nextIndex&gt;index; nextIndex--)  </div><div class="line">                    next = next.previous;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 是否存在下一个元素  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="comment">// 通过元素索引是否等于“双向链表大小”来判断是否达到最后。  </span></div><div class="line">            <span class="keyword">return</span> nextIndex != size;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 获取下一个元素  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;  </div><div class="line">            checkForComodification();  </div><div class="line">            <span class="keyword">if</span> (nextIndex == size)  </div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();  </div><div class="line"> </div><div class="line">            lastReturned = next;  </div><div class="line">            <span class="comment">// next指向链表的下一个元素  </span></div><div class="line">            next = next.next;  </div><div class="line">            nextIndex++;  </div><div class="line">            <span class="keyword">return</span> lastReturned.element;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 是否存在上一个元素  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasPrevious</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="comment">// 通过元素索引是否等于0，来判断是否达到开头。  </span></div><div class="line">            <span class="keyword">return</span> nextIndex != <span class="number">0</span>;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 获取上一个元素  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">previous</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">if</span> (nextIndex == <span class="number">0</span>)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();  </div><div class="line"> </div><div class="line">            <span class="comment">// next指向链表的上一个元素  </span></div><div class="line">            lastReturned = next = next.previous;  </div><div class="line">            nextIndex--;  </div><div class="line">            checkForComodification();  </div><div class="line">            <span class="keyword">return</span> lastReturned.element;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 获取下一个元素的索引  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">nextIndex</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> nextIndex;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 获取上一个元素的索引  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">previousIndex</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> nextIndex-<span class="number">1</span>;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 删除当前元素。  </span></div><div class="line">        <span class="comment">// 删除双向链表中的当前节点  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;  </div><div class="line">            checkForComodification();  </div><div class="line">            Entry&lt;E&gt; lastNext = lastReturned.next;  </div><div class="line">            <span class="keyword">try</span> &#123;  </div><div class="line">                LinkedList.<span class="keyword">this</span>.remove(lastReturned);  </div><div class="line">            &#125; <span class="keyword">catch</span> (NoSuchElementException e) &#123;  </div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();  </div><div class="line">            &#125;  </div><div class="line">            <span class="keyword">if</span> (next==lastReturned)  </div><div class="line">                next = lastNext;  </div><div class="line">            <span class="keyword">else</span> </div><div class="line">                nextIndex--;  </div><div class="line">            lastReturned = header;  </div><div class="line">            expectedModCount++;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 设置当前节点为e  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">            <span class="keyword">if</span> (lastReturned == header)  </div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();  </div><div class="line">            checkForComodification();  </div><div class="line">            lastReturned.element = e;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 将e添加到当前节点的前面  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;  </div><div class="line">            checkForComodification();  </div><div class="line">            lastReturned = header;  </div><div class="line">            addBefore(e, next);  </div><div class="line">            nextIndex++;  </div><div class="line">            expectedModCount++;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 判断 “modCount和expectedModCount是否相等”，依次来实现fail-fast机制。  </span></div><div class="line">        <span class="function"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title">checkForComodification</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">if</span> (modCount != expectedModCount)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 双向链表的节点所对应的数据结构。  </span></div><div class="line">    <span class="comment">// 包含3部分：上一节点，下一节点，当前节点值。  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span>&lt;<span class="title">E</span>&gt; </span>&#123;  </div><div class="line">        <span class="comment">// 当前节点所包含的值  </span></div><div class="line">        E element;  </div><div class="line">        <span class="comment">// 下一个节点  </span></div><div class="line">        Entry&lt;E&gt; next;  </div><div class="line">        <span class="comment">// 上一个节点  </span></div><div class="line">        Entry&lt;E&gt; previous;  </div><div class="line"> </div><div class="line">        <span class="comment">/**  </span></div><div class="line">         * 链表节点的构造函数。  </div><div class="line">         * 参数说明：  </div><div class="line">         *   element  —— 节点所包含的数据  </div><div class="line">         *   next      —— 下一个节点  </div><div class="line">         *   previous —— 上一个节点  </div><div class="line">         */ </div><div class="line">        Entry(E element, Entry&lt;E&gt; next, Entry&lt;E&gt; previous) &#123;  </div><div class="line">            <span class="keyword">this</span>.element = element;  </div><div class="line">            <span class="keyword">this</span>.next = next;  </div><div class="line">            <span class="keyword">this</span>.previous = previous;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将节点(节点数据是e)添加到entry节点之前。  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> Entry&lt;E&gt; <span class="title">addBefore</span><span class="params">(E e, Entry&lt;E&gt; entry)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 新建节点newEntry，将newEntry插入到节点e之前；并且设置newEntry的数据是e  </span></div><div class="line">        Entry&lt;E&gt; newEntry = <span class="keyword">new</span> Entry&lt;E&gt;(e, entry, entry.previous);  </div><div class="line">        newEntry.previous.next = newEntry;  </div><div class="line">        newEntry.next.previous = newEntry;  </div><div class="line">        <span class="comment">// 修改LinkedList大小  </span></div><div class="line">        size++;  </div><div class="line">        <span class="comment">// 修改LinkedList的修改统计数：用来实现fail-fast机制。  </span></div><div class="line">        modCount++;  </div><div class="line">        <span class="keyword">return</span> newEntry;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将节点从链表中删除  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> E <span class="title">remove</span><span class="params">(Entry&lt;E&gt; e)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (e == header)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();  </div><div class="line"> </div><div class="line">        E result = e.element;  </div><div class="line">        e.previous.next = e.next;  </div><div class="line">        e.next.previous = e.previous;  </div><div class="line">        e.next = e.previous = <span class="keyword">null</span>;  </div><div class="line">        e.element = <span class="keyword">null</span>;  </div><div class="line">        size--;  </div><div class="line">        modCount++;  </div><div class="line">        <span class="keyword">return</span> result;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 反向迭代器  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">descendingIterator</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DescendingIterator();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 反向迭代器实现类。  </span></div><div class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">DescendingIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span> </span>&#123;  </div><div class="line">        <span class="keyword">final</span> ListItr itr = <span class="keyword">new</span> ListItr(size());  </div><div class="line">        <span class="comment">// 反向迭代器是否下一个元素。  </span></div><div class="line">        <span class="comment">// 实际上是判断双向链表的当前节点是否达到开头  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> itr.hasPrevious();  </div><div class="line">        &#125;  </div><div class="line">        <span class="comment">// 反向迭代器获取下一个元素。  </span></div><div class="line">        <span class="comment">// 实际上是获取双向链表的前一个节点  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> itr.previous();  </div><div class="line">        &#125;  </div><div class="line">        <span class="comment">// 删除当前节点  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;  </div><div class="line">            itr.remove();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// 返回LinkedList的Object[]数组  </span></div><div class="line">    <span class="keyword">public</span> Object[] toArray() &#123;  </div><div class="line">    <span class="comment">// 新建Object[]数组  </span></div><div class="line">    Object[] result = <span class="keyword">new</span> Object[size];  </div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;  </div><div class="line">        <span class="comment">// 将链表中所有节点的数据都添加到Object[]数组中  </span></div><div class="line">        <span class="keyword">for</span> (Entry&lt;E&gt; e = header.next; e != header; e = e.next)  </div><div class="line">            result[i++] = e.element;  </div><div class="line">    <span class="keyword">return</span> result;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回LinkedList的模板数组。所谓模板数组，即可以将T设为任意的数据类型  </span></div><div class="line">    <span class="keyword">public</span> &lt;T&gt; T[] toArray(T[] a) &#123;  </div><div class="line">        <span class="comment">// 若数组a的大小 &lt; LinkedList的元素个数(意味着数组a不能容纳LinkedList中全部元素)  </span></div><div class="line">        <span class="comment">// 则新建一个T[]数组，T[]的大小为LinkedList大小，并将该T[]赋值给a。  </span></div><div class="line">        <span class="keyword">if</span> (a.length &lt; size)  </div><div class="line">            a = (T[])java.lang.reflect.Array.newInstance(  </div><div class="line">                                a.getClass().getComponentType(), size);  </div><div class="line">        <span class="comment">// 将链表中所有节点的数据都添加到数组a中  </span></div><div class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;  </div><div class="line">        Object[] result = a;  </div><div class="line">        <span class="keyword">for</span> (Entry&lt;E&gt; e = header.next; e != header; e = e.next)  </div><div class="line">            result[i++] = e.element;  </div><div class="line"> </div><div class="line">        <span class="keyword">if</span> (a.length &gt; size)  </div><div class="line">            a[size] = <span class="keyword">null</span>;  </div><div class="line"> </div><div class="line">        <span class="keyword">return</span> a;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// 克隆函数。返回LinkedList的克隆对象。  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;  </div><div class="line">        LinkedList&lt;E&gt; clone = <span class="keyword">null</span>;  </div><div class="line">        <span class="comment">// 克隆一个LinkedList克隆对象  </span></div><div class="line">        <span class="keyword">try</span> &#123;  </div><div class="line">            clone = (LinkedList&lt;E&gt;) <span class="keyword">super</span>.clone();  </div><div class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InternalError();  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 新建LinkedList表头节点  </span></div><div class="line">        clone.header = <span class="keyword">new</span> Entry&lt;E&gt;(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);  </div><div class="line">        clone.header.next = clone.header.previous = clone.header;  </div><div class="line">        clone.size = <span class="number">0</span>;  </div><div class="line">        clone.modCount = <span class="number">0</span>;  </div><div class="line"> </div><div class="line">        <span class="comment">// 将链表中所有节点的数据都添加到克隆对象中  </span></div><div class="line">        <span class="keyword">for</span> (Entry&lt;E&gt; e = header.next; e != header; e = e.next)  </div><div class="line">            clone.add(e.element);  </div><div class="line"> </div><div class="line">        <span class="keyword">return</span> clone;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// java.io.Serializable的写入函数  </span></div><div class="line">    <span class="comment">// 将LinkedList的“容量，所有的元素值”都写入到输出流中  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span>  </span></div><div class="line">        <span class="keyword">throws</span> java.io.IOException &#123;  </div><div class="line">        <span class="comment">// Write out any hidden serialization magic  </span></div><div class="line">        s.defaultWriteObject();  </div><div class="line"> </div><div class="line">        <span class="comment">// 写入“容量”  </span></div><div class="line">        s.writeInt(size);  </div><div class="line"> </div><div class="line">        <span class="comment">// 将链表中所有节点的数据都写入到输出流中  </span></div><div class="line">        <span class="keyword">for</span> (Entry e = header.next; e != header; e = e.next)  </div><div class="line">            s.writeObject(e.element);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// java.io.Serializable的读取函数：根据写入方式反向读出  </span></div><div class="line">    <span class="comment">// 先将LinkedList的“容量”读出，然后将“所有的元素值”读出  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span>  </span></div><div class="line">        <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException &#123;  </div><div class="line">        <span class="comment">// Read in any hidden serialization magic  </span></div><div class="line">        s.defaultReadObject();  </div><div class="line"> </div><div class="line">        <span class="comment">// 从输入流中读取“容量”  </span></div><div class="line">        <span class="keyword">int</span> size = s.readInt();  </div><div class="line"> </div><div class="line">        <span class="comment">// 新建链表表头节点  </span></div><div class="line">        header = <span class="keyword">new</span> Entry&lt;E&gt;(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>);  </div><div class="line">        header.next = header.previous = header;  </div><div class="line"> </div><div class="line">        <span class="comment">// 从输入流中将“所有的元素值”并逐个添加到链表中  </span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++)  </div><div class="line">            addBefore((E)s.readObject(), header);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><h3 id="HashMap和HashTable"><a href="#HashMap和HashTable" class="headerlink" title="HashMap和HashTable"></a>HashMap和HashTable</h3><p><strong>HashMap和HashTable的不同点</strong></p>
<ol>
<li>hashMap去掉了HashTable的<strong>contains</strong>方法，但是加上了<strong>containsValue()</strong>和<strong>containsKey()</strong>方法。</li>
<li>hashTable同步的，而HashMap是非同步的，效率上比hashTable要高。</li>
<li>hashMap允许<strong>NULL</strong>，而hashTable不允许。</li>
</ol>
<p>影响Hashtable的性能有初始容量和加载因子。加载因子 是对哈希表在其容量自动增加之前可以达到多满的一个尺度（默认0.75）。初始容量和加载因子这两个参数只是对该实现的提示。关于何时以及是否调用 rehash 方法的具体细节则依赖于该实现。</p>
<p><img src="http://img.blog.csdn.net/20150711103734904" alt="HashTable"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div></pre></td><td class="code"><pre><div class="line">	<span class="keyword">package</span> java.util;  </div><div class="line"><span class="keyword">import</span> java.io.*;  </div><div class="line"> </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;  </span></div><div class="line">    <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;  </div><div class="line">    <span class="keyword">implements</span> <span class="title">Map</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;, <span class="title">Cloneable</span>, <span class="title">Serializable</span>  </div><div class="line">&#123;  </div><div class="line"> </div><div class="line">    <span class="comment">// 默认的初始容量（容量为HashMap中槽的数目）是16，且实际容量必须是2的整数次幂。  </span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">16</span>;  </div><div class="line"> </div><div class="line">    <span class="comment">// 最大容量（必须是2的幂且小于2的30次方，传入容量过大将被这个值替换）  </span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAXIMUM_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">30</span>;  </div><div class="line"> </div><div class="line">    <span class="comment">// 默认加载因子为0.75 </span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="number">0.75f</span>;  </div><div class="line"> </div><div class="line">    <span class="comment">// 存储数据的Entry数组，长度是2的幂。  </span></div><div class="line">    <span class="comment">// HashMap采用链表法解决冲突，每一个Entry本质上是一个单向链表  </span></div><div class="line">    <span class="keyword">transient</span> Entry[] table;  </div><div class="line"> </div><div class="line">    <span class="comment">// HashMap的底层数组中已用槽的数量  </span></div><div class="line">    <span class="keyword">transient</span> <span class="keyword">int</span> size;  </div><div class="line"> </div><div class="line">    <span class="comment">// HashMap的阈值，用于判断是否需要调整HashMap的容量（threshold = 容量*加载因子）  </span></div><div class="line">    <span class="keyword">int</span> threshold;  </div><div class="line"> </div><div class="line">    <span class="comment">// 加载因子实际大小  </span></div><div class="line">    <span class="keyword">final</span> <span class="keyword">float</span> loadFactor;  </div><div class="line"> </div><div class="line">    <span class="comment">// HashMap被改变的次数  </span></div><div class="line">    <span class="keyword">transient</span> <span class="keyword">volatile</span> <span class="keyword">int</span> modCount;  </div><div class="line"> </div><div class="line">    <span class="comment">// 指定“容量大小”和“加载因子”的构造函数  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal initial capacity: "</span> +  </div><div class="line">                                               initialCapacity);  </div><div class="line">        <span class="comment">// HashMap的最大容量只能是MAXIMUM_CAPACITY  </span></div><div class="line">        <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)  </div><div class="line">            initialCapacity = MAXIMUM_CAPACITY;  </div><div class="line">		<span class="comment">//加载因此不能小于0</span></div><div class="line">        <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))  </div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Illegal load factor: "</span> +  </div><div class="line">                                               loadFactor);  </div><div class="line"> </div><div class="line">        <span class="comment">// 找出“大于initialCapacity”的最小的2的幂  </span></div><div class="line">        <span class="keyword">int</span> capacity = <span class="number">1</span>;  </div><div class="line">        <span class="keyword">while</span> (capacity &lt; initialCapacity)  </div><div class="line">            capacity &lt;&lt;= <span class="number">1</span>;  </div><div class="line"> </div><div class="line">        <span class="comment">// 设置“加载因子”  </span></div><div class="line">        <span class="keyword">this</span>.loadFactor = loadFactor;  </div><div class="line">        <span class="comment">// 设置“HashMap阈值”，当HashMap中存储数据的数量达到threshold时，就需要将HashMap的容量加倍。  </span></div><div class="line">        threshold = (<span class="keyword">int</span>)(capacity * loadFactor);  </div><div class="line">        <span class="comment">// 创建Entry数组，用来保存数据  </span></div><div class="line">        table = <span class="keyword">new</span> Entry[capacity];  </div><div class="line">        init();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">// 指定“容量大小”的构造函数  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>&#123;  </div><div class="line">        <span class="keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 默认构造函数。  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="comment">// 设置“加载因子”为默认加载因子0.75  </span></div><div class="line">        <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;  </div><div class="line">        <span class="comment">// 设置“HashMap阈值”，当HashMap中存储数据的数量达到threshold时，就需要将HashMap的容量加倍。  </span></div><div class="line">        threshold = (<span class="keyword">int</span>)(DEFAULT_INITIAL_CAPACITY * DEFAULT_LOAD_FACTOR);  </div><div class="line">        <span class="comment">// 创建Entry数组，用来保存数据  </span></div><div class="line">        table = <span class="keyword">new</span> Entry[DEFAULT_INITIAL_CAPACITY];  </div><div class="line">        init();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 包含“子Map”的构造函数  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m)</span> </span>&#123;  </div><div class="line">        <span class="keyword">this</span>(Math.max((<span class="keyword">int</span>) (m.size() / DEFAULT_LOAD_FACTOR) + <span class="number">1</span>,  </div><div class="line">                      DEFAULT_INITIAL_CAPACITY), DEFAULT_LOAD_FACTOR);  </div><div class="line">        <span class="comment">// 将m中的全部元素逐个添加到HashMap中  </span></div><div class="line">        putAllForCreate(m);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">//求hash值的方法，重新计算hash值</span></div><div class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(<span class="keyword">int</span> h)</span> </span>&#123;  </div><div class="line">        h ^= (h &gt;&gt;&gt; <span class="number">20</span>) ^ (h &gt;&gt;&gt; <span class="number">12</span>);  </div><div class="line">        <span class="keyword">return</span> h ^ (h &gt;&gt;&gt; <span class="number">7</span>) ^ (h &gt;&gt;&gt; <span class="number">4</span>);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回h在数组中的索引值，这里用&amp;代替取模，旨在提升效率 </span></div><div class="line">    <span class="comment">// h &amp; (length-1)保证返回值的小于length  </span></div><div class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">indexFor</span><span class="params">(<span class="keyword">int</span> h, <span class="keyword">int</span> length)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> h &amp; (length-<span class="number">1</span>);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> size;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> size == <span class="number">0</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 获取key对应的value  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (key == <span class="keyword">null</span>)  </div><div class="line">            <span class="keyword">return</span> getForNullKey();  </div><div class="line">        <span class="comment">// 获取key的hash值  </span></div><div class="line">        <span class="keyword">int</span> hash = hash(key.hashCode());  </div><div class="line">        <span class="comment">// 在“该hash值对应的链表”上查找“键值等于key”的元素  </span></div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[indexFor(hash, table.length)];  </div><div class="line">             e != <span class="keyword">null</span>;  </div><div class="line">             e = e.next) &#123;  </div><div class="line">            Object k;  </div><div class="line">			<span class="comment">//判断key是否相同</span></div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k)))  </div><div class="line">                <span class="keyword">return</span> e.value;  </div><div class="line">        &#125;</div><div class="line">		<span class="comment">//没找到则返回null</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 获取“key为null”的元素的值  </span></div><div class="line">    <span class="comment">// HashMap将“key为null”的元素存储在table[0]位置，但不一定是该链表的第一个位置！  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> V <span class="title">getForNullKey</span><span class="params">()</span> </span>&#123;  </div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[<span class="number">0</span>]; e != <span class="keyword">null</span>; e = e.next) &#123;  </div><div class="line">            <span class="keyword">if</span> (e.key == <span class="keyword">null</span>)  </div><div class="line">                <span class="keyword">return</span> e.value;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// HashMap是否包含key  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsKey</span><span class="params">(Object key)</span> </span>&#123;  </div><div class="line">        <span class="keyword">return</span> getEntry(key) != <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回“键为key”的键值对  </span></div><div class="line">    <span class="function"><span class="keyword">final</span> Entry&lt;K,V&gt; <span class="title">getEntry</span><span class="params">(Object key)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 获取哈希值  </span></div><div class="line">        <span class="comment">// HashMap将“key为null”的元素存储在table[0]位置，“key不为null”的则调用hash()计算哈希值  </span></div><div class="line">        <span class="keyword">int</span> hash = (key == <span class="keyword">null</span>) ? <span class="number">0</span> : hash(key.hashCode());  </div><div class="line">        <span class="comment">// 在“该hash值对应的链表”上查找“键值等于key”的元素  </span></div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[indexFor(hash, table.length)];  </div><div class="line">             e != <span class="keyword">null</span>;  </div><div class="line">             e = e.next) &#123;  </div><div class="line">            Object k;  </div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp;  </div><div class="line">                ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))  </div><div class="line">                <span class="keyword">return</span> e;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将“key-value”添加到HashMap中  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 若“key为null”，则将该键值对添加到table[0]中。  </span></div><div class="line">        <span class="keyword">if</span> (key == <span class="keyword">null</span>)  </div><div class="line">            <span class="keyword">return</span> putForNullKey(value);  </div><div class="line">        <span class="comment">// 若“key不为null”，则计算该key的哈希值，然后将其添加到该哈希值对应的链表中。  </span></div><div class="line">        <span class="keyword">int</span> hash = hash(key.hashCode());  </div><div class="line">        <span class="keyword">int</span> i = indexFor(hash, table.length);  </div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span class="keyword">null</span>; e = e.next) &#123;  </div><div class="line">            Object k;  </div><div class="line">            <span class="comment">// 若“该key”对应的键值对已经存在，则用新的value取代旧的value。然后退出！  </span></div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) &#123;  </div><div class="line">                V oldValue = e.value;  </div><div class="line">                e.value = value;  </div><div class="line">                e.recordAccess(<span class="keyword">this</span>);  </div><div class="line">                <span class="keyword">return</span> oldValue;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 若“该key”对应的键值对不存在，则将“key-value”添加到table中  </span></div><div class="line">        modCount++;</div><div class="line">		<span class="comment">//将key-value添加到table[i]处</span></div><div class="line">        addEntry(hash, key, value, i);  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// putForNullKey()的作用是将“key为null”键值对添加到table[0]位置  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> V <span class="title">putForNullKey</span><span class="params">(V value)</span> </span>&#123;  </div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[<span class="number">0</span>]; e != <span class="keyword">null</span>; e = e.next) &#123;  </div><div class="line">            <span class="keyword">if</span> (e.key == <span class="keyword">null</span>) &#123;  </div><div class="line">                V oldValue = e.value;  </div><div class="line">                e.value = value;  </div><div class="line">                e.recordAccess(<span class="keyword">this</span>);  </div><div class="line">                <span class="keyword">return</span> oldValue;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="comment">// 如果没有存在key为null的键值对，则直接题阿见到table[0]处!  </span></div><div class="line">        modCount++;  </div><div class="line">        addEntry(<span class="number">0</span>, <span class="keyword">null</span>, value, <span class="number">0</span>);  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 创建HashMap对应的“添加方法”，  </span></div><div class="line">    <span class="comment">// 它和put()不同。putForCreate()是内部方法，它被构造函数等调用，用来创建HashMap  </span></div><div class="line">    <span class="comment">// 而put()是对外提供的往HashMap中添加元素的方法。  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">putForCreate</span><span class="params">(K key, V value)</span> </span>&#123;  </div><div class="line">        <span class="keyword">int</span> hash = (key == <span class="keyword">null</span>) ? <span class="number">0</span> : hash(key.hashCode());  </div><div class="line">        <span class="keyword">int</span> i = indexFor(hash, table.length);  </div><div class="line"> </div><div class="line">        <span class="comment">// 若该HashMap表中存在“键值等于key”的元素，则替换该元素的value值  </span></div><div class="line">        <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span class="keyword">null</span>; e = e.next) &#123;  </div><div class="line">            Object k;  </div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp;  </div><div class="line">                ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k)))) &#123;  </div><div class="line">                e.value = value;  </div><div class="line">                <span class="keyword">return</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 若该HashMap表中不存在“键值等于key”的元素，则将该key-value添加到HashMap中  </span></div><div class="line">        createEntry(hash, key, value, i);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将“m”中的全部元素都添加到HashMap中。  </span></div><div class="line">    <span class="comment">// 该方法被内部的构造HashMap的方法所调用。  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">putAllForCreate</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 利用迭代器将元素逐个添加到HashMap中  </span></div><div class="line">        <span class="keyword">for</span> (Iterator&lt;? extends Map.Entry&lt;? extends K, ? extends V&gt;&gt; i = m.entrySet().iterator(); i.hasNext(); ) &#123;  </div><div class="line">            Map.Entry&lt;? extends K, ? extends V&gt; e = i.next();  </div><div class="line">            putForCreate(e.getKey(), e.getValue());  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 重新调整HashMap的大小，newCapacity是调整后的容量  </span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">resize</span><span class="params">(<span class="keyword">int</span> newCapacity)</span> </span>&#123;  </div><div class="line">        Entry[] oldTable = table;  </div><div class="line">        <span class="keyword">int</span> oldCapacity = oldTable.length; </div><div class="line">		<span class="comment">//如果就容量已经达到了最大值，则不能再扩容，直接返回</span></div><div class="line">        <span class="keyword">if</span> (oldCapacity == MAXIMUM_CAPACITY) &#123;  </div><div class="line">            threshold = Integer.MAX_VALUE;  </div><div class="line">            <span class="keyword">return</span>;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 新建一个HashMap，将“旧HashMap”的全部元素添加到“新HashMap”中，  </span></div><div class="line">        <span class="comment">// 然后，将“新HashMap”赋值给“旧HashMap”。  </span></div><div class="line">        Entry[] newTable = <span class="keyword">new</span> Entry[newCapacity];  </div><div class="line">        transfer(newTable);  </div><div class="line">        table = newTable;  </div><div class="line">        threshold = (<span class="keyword">int</span>)(newCapacity * loadFactor);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将HashMap中的全部元素都添加到newTable中  </span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">transfer</span><span class="params">(Entry[] newTable)</span> </span>&#123;  </div><div class="line">        Entry[] src = table;  </div><div class="line">        <span class="keyword">int</span> newCapacity = newTable.length;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; src.length; j++) &#123;  </div><div class="line">            Entry&lt;K,V&gt; e = src[j];  </div><div class="line">            <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123;  </div><div class="line">                src[j] = <span class="keyword">null</span>;  </div><div class="line">                do &#123;  </div><div class="line">                    Entry&lt;K,V&gt; next = e.next;  </div><div class="line">                    <span class="keyword">int</span> i = indexFor(e.hash, newCapacity);  </div><div class="line">                    e.next = newTable[i];  </div><div class="line">                    newTable[i] = e;  </div><div class="line">                    e = next;  </div><div class="line">                &#125; <span class="keyword">while</span> (e != <span class="keyword">null</span>);  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 将"m"的全部元素都添加到HashMap中  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">putAll</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 有效性判断  </span></div><div class="line">        <span class="keyword">int</span> numKeysToBeAdded = m.size();  </div><div class="line">        <span class="keyword">if</span> (numKeysToBeAdded == <span class="number">0</span>)  </div><div class="line">            <span class="keyword">return</span>;  </div><div class="line"> </div><div class="line">        <span class="comment">// 计算容量是否足够，  </span></div><div class="line">        <span class="comment">// 若“当前阀值容量 &lt; 需要的容量”，则将容量x2。  </span></div><div class="line">        <span class="keyword">if</span> (numKeysToBeAdded &gt; threshold) &#123;  </div><div class="line">            <span class="keyword">int</span> targetCapacity = (<span class="keyword">int</span>)(numKeysToBeAdded / loadFactor + <span class="number">1</span>);  </div><div class="line">            <span class="keyword">if</span> (targetCapacity &gt; MAXIMUM_CAPACITY)  </div><div class="line">                targetCapacity = MAXIMUM_CAPACITY;  </div><div class="line">            <span class="keyword">int</span> newCapacity = table.length;  </div><div class="line">            <span class="keyword">while</span> (newCapacity &lt; targetCapacity)  </div><div class="line">                newCapacity &lt;&lt;= <span class="number">1</span>;  </div><div class="line">            <span class="keyword">if</span> (newCapacity &gt; table.length)  </div><div class="line">                resize(newCapacity);  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 通过迭代器，将“m”中的元素逐个添加到HashMap中。  </span></div><div class="line">        <span class="keyword">for</span> (Iterator&lt;? extends Map.Entry&lt;? extends K, ? extends V&gt;&gt; i = m.entrySet().iterator(); i.hasNext(); ) &#123;  </div><div class="line">            Map.Entry&lt;? extends K, ? extends V&gt; e = i.next();  </div><div class="line">            put(e.getKey(), e.getValue());  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除“键为key”元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">remove</span><span class="params">(Object key)</span> </span>&#123;  </div><div class="line">        Entry&lt;K,V&gt; e = removeEntryForKey(key);  </div><div class="line">        <span class="keyword">return</span> (e == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除“键为key”的元素  </span></div><div class="line">    <span class="function"><span class="keyword">final</span> Entry&lt;K,V&gt; <span class="title">removeEntryForKey</span><span class="params">(Object key)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 获取哈希值。若key为null，则哈希值为0；否则调用hash()进行计算  </span></div><div class="line">        <span class="keyword">int</span> hash = (key == <span class="keyword">null</span>) ? <span class="number">0</span> : hash(key.hashCode());  </div><div class="line">        <span class="keyword">int</span> i = indexFor(hash, table.length);  </div><div class="line">        Entry&lt;K,V&gt; prev = table[i];  </div><div class="line">        Entry&lt;K,V&gt; e = prev;  </div><div class="line"> </div><div class="line">        <span class="comment">// 删除链表中“键为key”的元素  </span></div><div class="line">        <span class="comment">// 本质是“删除单向链表中的节点”  </span></div><div class="line">        <span class="keyword">while</span> (e != <span class="keyword">null</span>) &#123;  </div><div class="line">            Entry&lt;K,V&gt; next = e.next;  </div><div class="line">            Object k;  </div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp;  </div><div class="line">                ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k)))) &#123;  </div><div class="line">                modCount++;  </div><div class="line">                size--;  </div><div class="line">                <span class="keyword">if</span> (prev == e)  </div><div class="line">                    table[i] = next;  </div><div class="line">                <span class="keyword">else</span> </div><div class="line">                    prev.next = next;  </div><div class="line">                e.recordRemoval(<span class="keyword">this</span>);  </div><div class="line">                <span class="keyword">return</span> e;  </div><div class="line">            &#125;  </div><div class="line">            prev = e;  </div><div class="line">            e = next;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="keyword">return</span> e;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 删除“键值对”  </span></div><div class="line">    <span class="function"><span class="keyword">final</span> Entry&lt;K,V&gt; <span class="title">removeMapping</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">        <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Map.Entry))  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;  </div><div class="line"> </div><div class="line">        Map.Entry&lt;K,V&gt; entry = (Map.Entry&lt;K,V&gt;) o;  </div><div class="line">        Object key = entry.getKey();  </div><div class="line">        <span class="keyword">int</span> hash = (key == <span class="keyword">null</span>) ? <span class="number">0</span> : hash(key.hashCode());  </div><div class="line">        <span class="keyword">int</span> i = indexFor(hash, table.length);  </div><div class="line">        Entry&lt;K,V&gt; prev = table[i];  </div><div class="line">        Entry&lt;K,V&gt; e = prev;  </div><div class="line"> </div><div class="line">        <span class="comment">// 删除链表中的“键值对e”  </span></div><div class="line">        <span class="comment">// 本质是“删除单向链表中的节点”  </span></div><div class="line">        <span class="keyword">while</span> (e != <span class="keyword">null</span>) &#123;  </div><div class="line">            Entry&lt;K,V&gt; next = e.next;  </div><div class="line">            <span class="keyword">if</span> (e.hash == hash &amp;&amp; e.equals(entry)) &#123;  </div><div class="line">                modCount++;  </div><div class="line">                size--;  </div><div class="line">                <span class="keyword">if</span> (prev == e)  </div><div class="line">                    table[i] = next;  </div><div class="line">                <span class="keyword">else</span> </div><div class="line">                    prev.next = next;  </div><div class="line">                e.recordRemoval(<span class="keyword">this</span>);  </div><div class="line">                <span class="keyword">return</span> e;  </div><div class="line">            &#125;  </div><div class="line">            prev = e;  </div><div class="line">            e = next;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="keyword">return</span> e;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 清空HashMap，将所有的元素设为null  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;  </div><div class="line">        modCount++;  </div><div class="line">        Entry[] tab = table;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tab.length; i++)  </div><div class="line">            tab[i] = <span class="keyword">null</span>;  </div><div class="line">        size = <span class="number">0</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 是否包含“值为value”的元素  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsValue</span><span class="params">(Object value)</span> </span>&#123;  </div><div class="line">    <span class="comment">// 若“value为null”，则调用containsNullValue()查找  </span></div><div class="line">    <span class="keyword">if</span> (value == <span class="keyword">null</span>)  </div><div class="line">            <span class="keyword">return</span> containsNullValue();  </div><div class="line"> </div><div class="line">    <span class="comment">// 若“value不为null”，则查找HashMap中是否有值为value的节点。  </span></div><div class="line">    Entry[] tab = table;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tab.length ; i++)  </div><div class="line">            <span class="keyword">for</span> (Entry e = tab[i] ; e != <span class="keyword">null</span> ; e = e.next)  </div><div class="line">                <span class="keyword">if</span> (value.equals(e.value))  </div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 是否包含null值  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">containsNullValue</span><span class="params">()</span> </span>&#123;  </div><div class="line">    Entry[] tab = table;  </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tab.length ; i++)  </div><div class="line">            <span class="keyword">for</span> (Entry e = tab[i] ; e != <span class="keyword">null</span> ; e = e.next)  </div><div class="line">                <span class="keyword">if</span> (e.value == <span class="keyword">null</span>)  </div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 克隆一个HashMap，并返回Object对象  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;  </div><div class="line">        HashMap&lt;K,V&gt; result = <span class="keyword">null</span>;  </div><div class="line">        <span class="keyword">try</span> &#123;  </div><div class="line">            result = (HashMap&lt;K,V&gt;)<span class="keyword">super</span>.clone();  </div><div class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;  </div><div class="line">            <span class="comment">// assert false;  </span></div><div class="line">        &#125;  </div><div class="line">        result.table = <span class="keyword">new</span> Entry[table.length];  </div><div class="line">        result.entrySet = <span class="keyword">null</span>;  </div><div class="line">        result.modCount = <span class="number">0</span>;  </div><div class="line">        result.size = <span class="number">0</span>;  </div><div class="line">        result.init();  </div><div class="line">        <span class="comment">// 调用putAllForCreate()将全部元素添加到HashMap中  </span></div><div class="line">        result.putAllForCreate(<span class="keyword">this</span>);  </div><div class="line"> </div><div class="line">        <span class="keyword">return</span> result;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// Entry是单向链表。  </span></div><div class="line">    <span class="comment">// 它是 “HashMap链式存储法”对应的链表。  </span></div><div class="line">    <span class="comment">// 它实现了Map.Entry 接口，即实现getKey(), getValue(), setValue(V value), equals(Object o), hashCode()这些函数  </span></div><div class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;  </div><div class="line">        <span class="keyword">final</span> K key;  </div><div class="line">        V value;  </div><div class="line">        <span class="comment">// 指向下一个节点  </span></div><div class="line">        Entry&lt;K,V&gt; next;  </div><div class="line">        <span class="keyword">final</span> <span class="keyword">int</span> hash;  </div><div class="line"> </div><div class="line">        <span class="comment">// 构造函数。  </span></div><div class="line">        <span class="comment">// 输入参数包括"哈希值(h)", "键(k)", "值(v)", "下一节点(n)"  </span></div><div class="line">        Entry(<span class="keyword">int</span> h, K k, V v, Entry&lt;K,V&gt; n) &#123;  </div><div class="line">            value = v;  </div><div class="line">            next = n;  </div><div class="line">            key = k;  </div><div class="line">            hash = h;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> K <span class="title">getKey</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> key;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">getValue</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> value;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">setValue</span><span class="params">(V newValue)</span> </span>&#123;  </div><div class="line">            V oldValue = value;  </div><div class="line">            value = newValue;  </div><div class="line">            <span class="keyword">return</span> oldValue;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 判断两个Entry是否相等  </span></div><div class="line">        <span class="comment">// 若两个Entry的“key”和“value”都相等，则返回true。  </span></div><div class="line">        <span class="comment">// 否则，返回false  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">            <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Map.Entry))  </div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">            Map.Entry e = (Map.Entry)o;  </div><div class="line">            Object k1 = getKey();  </div><div class="line">            Object k2 = e.getKey();  </div><div class="line">            <span class="keyword">if</span> (k1 == k2 || (k1 != <span class="keyword">null</span> &amp;&amp; k1.equals(k2))) &#123;  </div><div class="line">                Object v1 = getValue();  </div><div class="line">                Object v2 = e.getValue();  </div><div class="line">                <span class="keyword">if</span> (v1 == v2 || (v1 != <span class="keyword">null</span> &amp;&amp; v1.equals(v2)))  </div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">            &#125;  </div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 实现hashCode()  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> (key==<span class="keyword">null</span>   ? <span class="number">0</span> : key.hashCode()) ^  </div><div class="line">                   (value==<span class="keyword">null</span> ? <span class="number">0</span> : value.hashCode());  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> getKey() + <span class="string">"="</span> + getValue();  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 当向HashMap中添加元素时，绘调用recordAccess()。  </span></div><div class="line">        <span class="comment">// 这里不做任何处理  </span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">recordAccess</span><span class="params">(HashMap&lt;K,V&gt; m)</span> </span>&#123;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 当从HashMap中删除元素时，绘调用recordRemoval()。  </span></div><div class="line">        <span class="comment">// 这里不做任何处理  </span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">recordRemoval</span><span class="params">(HashMap&lt;K,V&gt; m)</span> </span>&#123;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 新增Entry。将“key-value”插入指定位置，bucketIndex是位置索引。  </span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 保存“bucketIndex”位置的值到“e”中  </span></div><div class="line">        Entry&lt;K,V&gt; e = table[bucketIndex];  </div><div class="line">        <span class="comment">// 设置“bucketIndex”位置的元素为“新Entry”，  </span></div><div class="line">        <span class="comment">// 设置“e”为“新Entry的下一个节点”  </span></div><div class="line">        table[bucketIndex] = <span class="keyword">new</span> Entry&lt;K,V&gt;(hash, key, value, e);  </div><div class="line">        <span class="comment">// 若HashMap的实际大小 不小于 “阈值”，则调整HashMap的大小  </span></div><div class="line">        <span class="keyword">if</span> (size++ &gt;= threshold)  </div><div class="line">            resize(<span class="number">2</span> * table.length);  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 创建Entry。将“key-value”插入指定位置。  </span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;  </div><div class="line">        <span class="comment">// 保存“bucketIndex”位置的值到“e”中  </span></div><div class="line">        Entry&lt;K,V&gt; e = table[bucketIndex];  </div><div class="line">        <span class="comment">// 设置“bucketIndex”位置的元素为“新Entry”，  </span></div><div class="line">        <span class="comment">// 设置“e”为“新Entry的下一个节点”  </span></div><div class="line">        table[bucketIndex] = <span class="keyword">new</span> Entry&lt;K,V&gt;(hash, key, value, e);  </div><div class="line">        size++;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// HashIterator是HashMap迭代器的抽象出来的父类，实现了公共了函数。  </span></div><div class="line">    <span class="comment">// 它包含“key迭代器(KeyIterator)”、“Value迭代器(ValueIterator)”和“Entry迭代器(EntryIterator)”3个子类。  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HashIterator</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;  </div><div class="line">        <span class="comment">// 下一个元素  </span></div><div class="line">        Entry&lt;K,V&gt; next;  </div><div class="line">        <span class="comment">// expectedModCount用于实现fast-fail机制。  </span></div><div class="line">        <span class="keyword">int</span> expectedModCount;  </div><div class="line">        <span class="comment">// 当前索引  </span></div><div class="line">        <span class="keyword">int</span> index;  </div><div class="line">        <span class="comment">// 当前元素  </span></div><div class="line">        Entry&lt;K,V&gt; current;  </div><div class="line"> </div><div class="line">        HashIterator() &#123;  </div><div class="line">            expectedModCount = modCount;  </div><div class="line">            <span class="keyword">if</span> (size &gt; <span class="number">0</span>) &#123; <span class="comment">// advance to first entry  </span></div><div class="line">                Entry[] t = table;  </div><div class="line">                <span class="comment">// 将next指向table中第一个不为null的元素。  </span></div><div class="line">                <span class="comment">// 这里利用了index的初始值为0，从0开始依次向后遍历，直到找到不为null的元素就退出循环。  </span></div><div class="line">                <span class="keyword">while</span> (index &lt; t.length &amp;&amp; (next = t[index++]) == <span class="keyword">null</span>)  </div><div class="line">                    ;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> next != <span class="keyword">null</span>;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 获取下一个元素  </span></div><div class="line">        <span class="function"><span class="keyword">final</span> Entry&lt;K,V&gt; <span class="title">nextEntry</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">if</span> (modCount != expectedModCount)  </div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();  </div><div class="line">            Entry&lt;K,V&gt; e = next;  </div><div class="line">            <span class="keyword">if</span> (e == <span class="keyword">null</span>)  </div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();  </div><div class="line"> </div><div class="line">            <span class="comment">// 注意！！！  </span></div><div class="line">            <span class="comment">// 一个Entry就是一个单向链表  </span></div><div class="line">            <span class="comment">// 若该Entry的下一个节点不为空，就将next指向下一个节点;  </span></div><div class="line">            <span class="comment">// 否则，将next指向下一个链表(也是下一个Entry)的不为null的节点。  </span></div><div class="line">            <span class="keyword">if</span> ((next = e.next) == <span class="keyword">null</span>) &#123;  </div><div class="line">                Entry[] t = table;  </div><div class="line">                <span class="keyword">while</span> (index &lt; t.length &amp;&amp; (next = t[index++]) == <span class="keyword">null</span>)  </div><div class="line">                    ;  </div><div class="line">            &#125;  </div><div class="line">            current = e;  </div><div class="line">            <span class="keyword">return</span> e;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">        <span class="comment">// 删除当前元素  </span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">if</span> (current == <span class="keyword">null</span>)  </div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();  </div><div class="line">            <span class="keyword">if</span> (modCount != expectedModCount)  </div><div class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();  </div><div class="line">            Object k = current.key;  </div><div class="line">            current = <span class="keyword">null</span>;  </div><div class="line">            HashMap.<span class="keyword">this</span>.removeEntryForKey(k);  </div><div class="line">            expectedModCount = modCount;  </div><div class="line">        &#125;  </div><div class="line"> </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// value的迭代器  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ValueIterator</span> <span class="keyword">extends</span> <span class="title">HashIterator</span>&lt;<span class="title">V</span>&gt; </span>&#123;  </div><div class="line">        <span class="function"><span class="keyword">public</span> V <span class="title">next</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> nextEntry().value;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// key的迭代器  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">KeyIterator</span> <span class="keyword">extends</span> <span class="title">HashIterator</span>&lt;<span class="title">K</span>&gt; </span>&#123;  </div><div class="line">        <span class="function"><span class="keyword">public</span> K <span class="title">next</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> nextEntry().getKey();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// Entry的迭代器  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">EntryIterator</span> <span class="keyword">extends</span> <span class="title">HashIterator</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;&gt; </span>&#123;  </div><div class="line">        <span class="keyword">public</span> Map.<span class="function">Entry&lt;K,V&gt; <span class="title">next</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> nextEntry();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回一个“key迭代器”  </span></div><div class="line">    <span class="function">Iterator&lt;K&gt; <span class="title">newKeyIterator</span><span class="params">()</span>   </span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> KeyIterator();  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">// 返回一个“value迭代器”  </span></div><div class="line">    <span class="function">Iterator&lt;V&gt; <span class="title">newValueIterator</span><span class="params">()</span>   </span>&#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ValueIterator();  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">// 返回一个“entry迭代器”  </span></div><div class="line">    Iterator&lt;Map.Entry&lt;K,V&gt;&gt; newEntryIterator()   &#123;  </div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> EntryIterator();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// HashMap的Entry对应的集合  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet = <span class="keyword">null</span>;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回“key的集合”，实际上返回一个“KeySet对象”  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> Set&lt;K&gt; <span class="title">keySet</span><span class="params">()</span> </span>&#123;  </div><div class="line">        Set&lt;K&gt; ks = keySet;  </div><div class="line">        <span class="keyword">return</span> (ks != <span class="keyword">null</span> ? ks : (keySet = <span class="keyword">new</span> KeySet()));  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// Key对应的集合  </span></div><div class="line">    <span class="comment">// KeySet继承于AbstractSet，说明该集合中没有重复的Key。  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">KeySet</span> <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">K</span>&gt; </span>&#123;  </div><div class="line">        <span class="function"><span class="keyword">public</span> Iterator&lt;K&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> newKeyIterator();  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> size;  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> containsKey(o);  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> HashMap.<span class="keyword">this</span>.removeEntryForKey(o) != <span class="keyword">null</span>;  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;  </div><div class="line">            HashMap.<span class="keyword">this</span>.clear();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回“value集合”，实际上返回的是一个Values对象  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> Collection&lt;V&gt; <span class="title">values</span><span class="params">()</span> </span>&#123;  </div><div class="line">        Collection&lt;V&gt; vs = values;  </div><div class="line">        <span class="keyword">return</span> (vs != <span class="keyword">null</span> ? vs : (values = <span class="keyword">new</span> Values()));  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// “value集合”  </span></div><div class="line">    <span class="comment">// Values继承于AbstractCollection，不同于“KeySet继承于AbstractSet”，  </span></div><div class="line">    <span class="comment">// Values中的元素能够重复。因为不同的key可以指向相同的value。  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Values</span> <span class="keyword">extends</span> <span class="title">AbstractCollection</span>&lt;<span class="title">V</span>&gt; </span>&#123;  </div><div class="line">        <span class="function"><span class="keyword">public</span> Iterator&lt;V&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> newValueIterator();  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> size;  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> containsValue(o);  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;  </div><div class="line">            HashMap.<span class="keyword">this</span>.clear();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回“HashMap的Entry集合”  </span></div><div class="line">    <span class="keyword">public</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet() &#123;  </div><div class="line">        <span class="keyword">return</span> entrySet0();  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回“HashMap的Entry集合”，它实际是返回一个EntrySet对象  </span></div><div class="line">    <span class="keyword">private</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet0() &#123;  </div><div class="line">        Set&lt;Map.Entry&lt;K,V&gt;&gt; es = entrySet;  </div><div class="line">        <span class="keyword">return</span> es != <span class="keyword">null</span> ? es : (entrySet = <span class="keyword">new</span> EntrySet());  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// EntrySet对应的集合  </span></div><div class="line">    <span class="comment">// EntrySet继承于AbstractSet，说明该集合中没有重复的EntrySet。  </span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">EntrySet</span> <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;&gt; </span>&#123;  </div><div class="line">        <span class="keyword">public</span> Iterator&lt;Map.Entry&lt;K,V&gt;&gt; iterator() &#123;  </div><div class="line">            <span class="keyword">return</span> newEntryIterator();  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">            <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Map.Entry))  </div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">            Map.Entry&lt;K,V&gt; e = (Map.Entry&lt;K,V&gt;) o;  </div><div class="line">            Entry&lt;K,V&gt; candidate = getEntry(e.getKey());  </div><div class="line">            <span class="keyword">return</span> candidate != <span class="keyword">null</span> &amp;&amp; candidate.equals(e);  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> removeMapping(o) != <span class="keyword">null</span>;  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;  </div><div class="line">            <span class="keyword">return</span> size;  </div><div class="line">        &#125;  </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;  </div><div class="line">            HashMap.<span class="keyword">this</span>.clear();  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// java.io.Serializable的写入函数  </span></div><div class="line">    <span class="comment">// 将HashMap的“总的容量，实际容量，所有的Entry”都写入到输出流中  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span>  </span></div><div class="line">        <span class="keyword">throws</span> IOException  </div><div class="line">    &#123;  </div><div class="line">        Iterator&lt;Map.Entry&lt;K,V&gt;&gt; i =  </div><div class="line">            (size &gt; <span class="number">0</span>) ? entrySet0().iterator() : <span class="keyword">null</span>;  </div><div class="line"> </div><div class="line">        <span class="comment">// Write out the threshold, loadfactor, and any hidden stuff  </span></div><div class="line">        s.defaultWriteObject();  </div><div class="line"> </div><div class="line">        <span class="comment">// Write out number of buckets  </span></div><div class="line">        s.writeInt(table.length);  </div><div class="line"> </div><div class="line">        <span class="comment">// Write out size (number of Mappings)  </span></div><div class="line">        s.writeInt(size);  </div><div class="line"> </div><div class="line">        <span class="comment">// Write out keys and values (alternating)  </span></div><div class="line">        <span class="keyword">if</span> (i != <span class="keyword">null</span>) &#123;  </div><div class="line">            <span class="keyword">while</span> (i.hasNext()) &#123;  </div><div class="line">            Map.Entry&lt;K,V&gt; e = i.next();  </div><div class="line">            s.writeObject(e.getKey());  </div><div class="line">            s.writeObject(e.getValue());  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">362498820763181265L</span>;  </div><div class="line"> </div><div class="line">    <span class="comment">// java.io.Serializable的读取函数：根据写入方式读出  </span></div><div class="line">    <span class="comment">// 将HashMap的“总的容量，实际容量，所有的Entry”依次读出  </span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span>  </span></div><div class="line">         <span class="keyword">throws</span> IOException, ClassNotFoundException  </div><div class="line">    &#123;  </div><div class="line">        <span class="comment">// Read in the threshold, loadfactor, and any hidden stuff  </span></div><div class="line">        s.defaultReadObject();  </div><div class="line"> </div><div class="line">        <span class="comment">// Read in number of buckets and allocate the bucket array;  </span></div><div class="line">        <span class="keyword">int</span> numBuckets = s.readInt();  </div><div class="line">        table = <span class="keyword">new</span> Entry[numBuckets];  </div><div class="line"> </div><div class="line">        init();  <span class="comment">// Give subclass a chance to do its thing.  </span></div><div class="line"> </div><div class="line">        <span class="comment">// Read in size (number of Mappings)  </span></div><div class="line">        <span class="keyword">int</span> size = s.readInt();  </div><div class="line"> </div><div class="line">        <span class="comment">// Read the keys and values, and put the mappings in the HashMap  </span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++) &#123;  </div><div class="line">            K key = (K) s.readObject();  </div><div class="line">            V value = (V) s.readObject();  </div><div class="line">            putForCreate(key, value);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"> </div><div class="line">    <span class="comment">// 返回“HashMap总的容量”  </span></div><div class="line">    <span class="function"><span class="keyword">int</span>   <span class="title">capacity</span><span class="params">()</span>     </span>&#123; <span class="keyword">return</span> table.length; &#125;  </div><div class="line">    <span class="comment">// 返回“HashMap的加载因子”  </span></div><div class="line">    <span class="function"><span class="keyword">float</span> <span class="title">loadFactor</span><span class="params">()</span>   </span>&#123; <span class="keyword">return</span> loadFactor;   &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>HashMap共有四个构造方法。构造方法中提到了两个很重要的参数：<strong>初始容量</strong>和<strong>加载因子</strong>。这两个参数是影响HashMap性能的重要参数，其中容量表示哈希表中槽的数量（即哈希数组的长度），初始容量是创建哈希表时的容量（从构造函数中可以看出，如果不指明，则默认为16），加载因子是哈希表在其容量自动增加之前可以达到多满的一种尺度，当哈希表中的条目数超出了加载因子与当前容量的乘积时，则要对该哈希表进行 resize 操作（即扩容）。</p>
</li>
<li><p>下面说下加载因子，如果加载因子越大，对空间的利用更充分，但是查找效率会降低（链表长度会越来越长）；如果加载因子太小，那么表中的数据将过于稀疏（很多空间还没用，就开始扩容了），对空间造成严重浪费。如果我们在构造方法中不指定，则系统默认加载因子为0.75，这是一个比较理想的值，一般情况下我们是无需修改的。</p>
</li>
<li><p>另外，无论我们指定的容量为多少，构造方法都会将实际容量设为不小于指定容量的2的次方的一个数，且最大值不能超过2的30次方</p>
</li>
<li><p>HashMap中key和value都允许为null。</p>
<p>要重点分析下HashMap中用的最多的两个方法put和get。先从比较简单的get方法着手，源码如下：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 获取key对应的value    </span></div><div class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;    </div><div class="line">    <span class="keyword">if</span> (key == <span class="keyword">null</span>)    </div><div class="line">        <span class="keyword">return</span> getForNullKey();    </div><div class="line">    <span class="comment">// 获取key的hash值    </span></div><div class="line">    <span class="keyword">int</span> hash = hash(key.hashCode());    </div><div class="line">    <span class="comment">// 在“该hash值对应的链表”上查找“键值等于key”的元素    </span></div><div class="line">    <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[indexFor(hash, table.length)];    </div><div class="line">         e != <span class="keyword">null</span>;    </div><div class="line">         e = e.next) &#123;    </div><div class="line">        Object k;    </div><div class="line">/判断key是否相同  </div><div class="line">        <span class="keyword">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k)))    </div><div class="line">            <span class="keyword">return</span> e.value;    </div><div class="line">    &#125;  </div><div class="line">没找到则返回<span class="keyword">null</span>  </div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;    </div><div class="line">&#125;    </div><div class="line">  </div><div class="line"><span class="comment">// 获取“key为null”的元素的值    </span></div><div class="line"><span class="comment">// HashMap将“key为null”的元素存储在table[0]位置，但不一定是该链表的第一个位置！    </span></div><div class="line"><span class="function"><span class="keyword">private</span> V <span class="title">getForNullKey</span><span class="params">()</span> </span>&#123;    </div><div class="line">    <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[<span class="number">0</span>]; e != <span class="keyword">null</span>; e = e.next) &#123;    </div><div class="line">        <span class="keyword">if</span> (e.key == <span class="keyword">null</span>)    </div><div class="line">            <span class="keyword">return</span> e.value;    </div><div class="line">    &#125;    </div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>首先，如果key为null，则直接从哈希表的第一个位置table[0]对应的链表上查找。记住，<strong>key为null的键值对永远都放在以table[0]为头结点的链表中</strong>，当然不一定是存放在头结点table[0]中。</p>
</li>
<li><p>如果key不为null，则先求的key的hash值，根据hash值找到在table中的索引，在该索引对应的单链表中查找是否有键值对的key与目标key相等，有就返回对应的value，没有则返回null。</p>
</li>
</ul>
<p><strong>put方法稍微复杂些，代码如下：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">// 将“key-value”添加到HashMap中    </span></div><div class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;    </div><div class="line">      <span class="comment">// 若“key为null”，则将该键值对添加到table[0]中。    </span></div><div class="line">      <span class="keyword">if</span> (key == <span class="keyword">null</span>)    </div><div class="line">          <span class="keyword">return</span> putForNullKey(value);    </div><div class="line">      <span class="comment">// 若“key不为null”，则计算该key的哈希值，然后将其添加到该哈希值对应的链表中。    </span></div><div class="line">      <span class="keyword">int</span> hash = hash(key.hashCode());    </div><div class="line">      <span class="keyword">int</span> i = indexFor(hash, table.length);    </div><div class="line">      <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span class="keyword">null</span>; e = e.next) &#123;    </div><div class="line">          Object k;    </div><div class="line">          <span class="comment">// 若“该key”对应的键值对已经存在，则用新的value取代旧的value。然后退出！    </span></div><div class="line">          <span class="keyword">if</span> (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) &#123;    </div><div class="line">              V oldValue = e.value;    </div><div class="line">              e.value = value;    </div><div class="line">              e.recordAccess(<span class="keyword">this</span>);    </div><div class="line">              <span class="keyword">return</span> oldValue;    </div><div class="line">          &#125;    </div><div class="line">      &#125;    </div><div class="line">  </div><div class="line">      <span class="comment">// 若“该key”对应的键值对不存在，则将“key-value”添加到table中    </span></div><div class="line">      modCount++;  </div><div class="line"><span class="comment">//将key-value添加到table[i]处  </span></div><div class="line">      addEntry(hash, key, value, i);    </div><div class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;    </div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>如果key为null，则将其添加到table[0]对应的链表中，putForNullKey的源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// putForNullKey()的作用是将“key为null”键值对添加到table[0]位置    </span></div><div class="line"><span class="function"><span class="keyword">private</span> V <span class="title">putForNullKey</span><span class="params">(V value)</span> </span>&#123;    </div><div class="line">    <span class="keyword">for</span> (Entry&lt;K,V&gt; e = table[<span class="number">0</span>]; e != <span class="keyword">null</span>; e = e.next) &#123;    </div><div class="line">        <span class="keyword">if</span> (e.key == <span class="keyword">null</span>) &#123;    </div><div class="line">            V oldValue = e.value;    </div><div class="line">            e.value = value;    </div><div class="line">            e.recordAccess(<span class="keyword">this</span>);    </div><div class="line">            <span class="keyword">return</span> oldValue;    </div><div class="line">        &#125;    </div><div class="line">    &#125;    </div><div class="line">    <span class="comment">// 如果没有存在key为null的键值对，则直接题阿见到table[0]处!    </span></div><div class="line">    modCount++;    </div><div class="line">    addEntry(<span class="number">0</span>, <span class="keyword">null</span>, value, <span class="number">0</span>);    </div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 如果key不为null，则同样先求出key的hash值，根据hash值得出在table中的索引，而后遍历对应的单链表，如果单链表中存在与目标key相等的键值对，则将新的value覆盖旧的value，比将旧的value返回，如果找不到与目标key相等的键值对，或者该单链表为空，则将该键值对插入到改单链表的头结点位置（每次新插入的节点都是放在头结点的位置），该操作是有addEntry方法实现的，它的源码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 新增Entry。将“key-value”插入指定位置，bucketIndex是位置索引。    </span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> bucketIndex)</span> </span>&#123;    </div><div class="line">    <span class="comment">// 保存“bucketIndex”位置的值到“e”中    </span></div><div class="line">    Entry&lt;K,V&gt; e = table[bucketIndex];    </div><div class="line">    <span class="comment">// 设置“bucketIndex”位置的元素为“新Entry”，    </span></div><div class="line">    <span class="comment">// 设置“e”为“新Entry的下一个节点”    </span></div><div class="line">    table[bucketIndex] = <span class="keyword">new</span> Entry&lt;K,V&gt;(hash, key, value, e);    </div><div class="line">    <span class="comment">// 若HashMap的实际大小 不小于 “阈值”，则调整HashMap的大小    </span></div><div class="line">    <span class="keyword">if</span> (size++ &gt;= threshold)    </div><div class="line">        resize(<span class="number">2</span> * table.length);    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>注意这里倒数第三行的构造方法，将key-value键值对赋给table[bucketIndex]，并将其next指向元素e，这便将key-value放到了头结点中，并将之前的头结点接在了它的后面。该方法也说明，每次put键值对的时候，总是将新的该键值对放在table[bucketIndex]处（即头结点处）。<br>两外注意最后两行代码，每次加入键值对时，都要判断当前已用的槽的数目是否大于等于阀值（容量*加载因子），如果大于等于，则进行扩容，将容量扩为原来容量的2倍。</li>
</ul>
<p><strong>关于扩容。上面我们看到了扩容的方法，resize方法，它的源码如下：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 重新调整HashMap的大小，newCapacity是调整后的单位    </span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">resize</span><span class="params">(<span class="keyword">int</span> newCapacity)</span> </span>&#123;    </div><div class="line">    Entry[] oldTable = table;    </div><div class="line">    <span class="keyword">int</span> oldCapacity = oldTable.length;    </div><div class="line">    <span class="keyword">if</span> (oldCapacity == MAXIMUM_CAPACITY) &#123;    </div><div class="line">        threshold = Integer.MAX_VALUE;    </div><div class="line">        <span class="keyword">return</span>;    </div><div class="line">    &#125;    </div><div class="line">  </div><div class="line">    <span class="comment">// 新建一个HashMap，将“旧HashMap”的全部元素添加到“新HashMap”中，    </span></div><div class="line">    <span class="comment">// 然后，将“新HashMap”赋值给“旧HashMap”。    </span></div><div class="line">    Entry[] newTable = <span class="keyword">new</span> Entry[newCapacity];    </div><div class="line">    transfer(newTable);    </div><div class="line">    table = newTable;    </div><div class="line">    threshold = (<span class="keyword">int</span>)(newCapacity * loadFactor);    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>   很明显，是新建了一个HashMap的底层数组，而后调用transfer方法，将就HashMap的全部元素添加到新的HashMap中（要重新计算元素在新的数组中的索引位置）。transfer方法的源码如下：</p>
<pre><code class="java">
<span class="comment">// 将HashMap中的全部元素都添加到newTable中    </span>
<span class="function"><span class="keyword">void</span> <span class="title">transfer</span><span class="params">(Entry[] newTable)</span> </span>{    
    Entry[] src = table;    
    <span class="keyword">int</span> newCapacity = newTable.length;    
    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; src.length; j++) {    
        Entry&lt;K,V&gt; e = src[j];    
        <span class="keyword">if</span> (e != <span class="keyword">null</span>) {    
            src[j] = <span class="keyword">null</span>;    
            do {    
                Entry&lt;K,V&gt; next = e.next;    
                <span class="keyword">int</span> i = indexFor(e.hash, newCapacity);    
                e.next = newTable[i];    
                newTable[i] = e;    
                e = next;    
            } <span class="keyword">while</span> (e != <span class="keyword">null</span>);    
        }    
    }    
}
</code></pre>
<p>很明显，扩容是一个相当耗时的操作，因为它需要重新计算这些元素在新的数组中的位置并进行复制处理。因此，我们在用HashMap的时，最好能提前预估下HashMap中元素的个数，这样有助于提高HashMap的性能。</p>
<ul>
<li><p>注意containsKey方法和containsValue方法。前者直接可以通过key的哈希值将搜索范围定位到指定索引对应的链表，而后者要对哈希数组的每个链表进行搜索。</p>
</li>
<li><p>我们重点来分析下求hash值和索引值的方法，这两个方法便是HashMap设计的最为核心的部分，二者结合能保证哈希表中的元素尽可能均匀地散列。</p>
<p>  <strong>计算哈希值的方法如下：</strong></p>
<p>  static int hash(int h) {  </p>
<pre><code>h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12);  
return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4);  
</code></pre><p>  }  </p>
</li>
</ul>
<p>它只是一个数学公式，JDK这样设计对hash值的计算，自然有它的好处，至于为什么这样设计，我们这里不去追究，只要明白一点，用的位的操作使hash值的计算效率很高。</p>
<p>由hash值找到对应索引的方法如下：</p>
<pre><code>static int indexFor(int h, int length) {  
    return h &amp; (length-1);  
}
</code></pre><p> 这个我们要重点说下，我们一般对哈希表的散列很自然地会想到用hash值对length取模（即除法散列法），Hashtable中也是这样实现的，这种方法基本能保证元素在哈希表中散列的比较均匀，但取模会用到除法运算，效率很低，HashMap中则通过h&amp;(length-1)的方法来代替取模，同样实现了均匀的散列，但效率要高很多，这也是HashMap对Hashtable的一个改进。</p>
<p>接下来，我们分析下为什么哈希表的容量一定要是2的整数次幂。首先，length为2的整数次幂的话，h&amp;(length-1)就相当于对length取模，这样便保证了散列的均匀，同时也提升了效率；其次，length为2的整数次幂的话，为偶数，这样length-1为奇数，奇数的最后一位是1，这样便保证了h&amp;(length-1)的最后一位可能为0，也可能为1（这取决于h的值），即与后的结果可能为偶数，也可能为奇数，这样便可以保证散列的均匀性，而如果length为奇数的话，很明显length-1为偶数，它的最后一位是0，这样h&amp;(length-1)的最后一位肯定为0，即只能为偶数，这样任何hash值都只会被散列到数组的偶数下标位置上，这便浪费了近一半的空间，因此，length取2的整数次幂，是为了使不同hash值发生碰撞的概率较小，这样就能使元素在哈希表中均匀地散列。</p>
<p>针对Hashtable，我们同样给出几点比较重要的总结，但要结合与HashMap的比较来总结。</p>
<ol>
<li>二者的存储结构和解决冲突的方法都是相同的。</li>
<li>HashTable在不指定容量的情况下的默认容量为11，而HashMap为16，Hashtable不要求底层数组的容量一定要为2的整数次幂，而HashMap则要求一定为2的整数次幂。</li>
<li>Hashtable中key和value都不允许为null，而HashMap中key和value都允许为null（key只能有一个为null，而value则可以有多个为null）。但是如果在Hashtable中有类似put(null,null)的操作，编译同样可以通过，因为key和value都是Object类型，但运行时会抛出NullPointerException异常，这是JDK的规范规定的。</li>
<li>Hashtable扩容时，将容量变为原来的2倍加1，而HashMap扩容时，将容量变为原来的2倍。</li>
<li>Hashtable计算hash值，直接用key的hashCode()，而HashMap重新计算了key的hash值，Hashtable在求hash值对应的位置索引时，用取模运算，而HashMap在求位置索引时，则用与运算，且这里一般先用hash&amp;0x7FFFFFFF后，再对length取模，&amp;0x7FFFFFFF的目的是为了将负的hash值转化为正值，因为hash值有可能为负数，而&amp;0x7FFFFFFF后，<code>只有符号外改变，而后面的位都不变。</code></li>
</ol>
<h3 id="LinkedHashMap源码解析"><a href="#LinkedHashMap源码解析" class="headerlink" title="LinkedHashMap源码解析"></a>LinkedHashMap源码解析</h3><h3 id="HashSet和TreeSet"><a href="#HashSet和TreeSet" class="headerlink" title="HashSet和TreeSet"></a>HashSet和TreeSet</h3><blockquote>
<p>直接用的HashMap和TreeMap来实现，值为new Object()</p>
</blockquote>

      
    </div>

  
  
</article>

  
<section id="comments">
    <!-- 多说分享框 -->
    <div class="ds-share flat" data-thread-key="/2015/07/11/集合类解析/" data-title="集合类解析" data-images="https://raw.githubusercontent.com/Hankiya/LoveOnline/master/Rich%20Format%20Vertical.png" data-content="集合类解析" data-url="//2015/07/11/集合类解析/">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">

      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
   </div>
    <!-- 多说评论框 start -->
   	<div class="ds-thread" data-thread-key="/2015/07/11/集合类解析/" data-title="集合类解析" data-url="//2015/07/11/集合类解析/"></div>
   <!-- 多说评论框 end -->
   <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
   <script type="text/javascript">
   var duoshuoQuery = {short_name:"hanks-zyh"};
   	(function() {
   		var ds = document.createElement('script');
   		ds.type = 'text/javascript';ds.async = true;
   		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
   		ds.charset = 'UTF-8';
   		(document.getElementsByTagName('head')[0]
   		 || document.getElementsByTagName('body')[0]).appendChild(ds);
   	})();
   	</script>
   <!-- 多说公共JS代码 end -->
</section>

</section>
      </div>
      <footer id="footer">
  
  <div class="outer footer_center">
    <div id="footer-info" class="inner">
      &copy; 2016 Kevin<br>
      彼此当年少，莫负好时光
  </br>
    </div>
  </div>
</footer>

    </div>
    

<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollLoading.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>