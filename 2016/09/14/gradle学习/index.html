<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>gradle学习 | Kevin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Groovy基础常见语法类Groovy可以和Java一样声明和使用一个类,定义和使用一个方法。同时也提供了一个属性的默认的get和set方法
1234567891011121314151617181920212223242526272829class Person &amp;#123;	private String name;	public Person(String name) &amp;#123;		this">
<meta property="og:type" content="article">
<meta property="og:title" content="gradle学习">
<meta property="og:url" content="/2016/09/14/gradle学习/index.html">
<meta property="og:site_name" content="Kevin">
<meta property="og:description" content="Groovy基础常见语法类Groovy可以和Java一样声明和使用一个类,定义和使用一个方法。同时也提供了一个属性的默认的get和set方法
1234567891011121314151617181920212223242526272829class Person &amp;#123;	private String name;	public Person(String name) &amp;#123;		this">
<meta property="og:image" content="http://ww2.sinaimg.cn/large/7853084cjw1f801i9018aj20dz0420sv.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/7853084cjw1f801m75ijyj20la0foacw.jpg">
<meta property="og:image" content="http://ww2.sinaimg.cn/large/7853084cjw1f801mvhf8qj20pq0gvq6w.jpg">
<meta property="og:image" content="http://ww2.sinaimg.cn/large/7853084cjw1f801o7sq3aj20es05mwet.jpg">
<meta property="og:image" content="http://cdn4.infoqstatic.com/statics_s2_20160914-0333/resource/articles/android-in-depth-gradle/zh/resources/image028.png">
<meta property="og:image" content="http://ww3.sinaimg.cn/large/7853084cjw1f809gxpn6mj20dj02h0t0.jpg">
<meta property="og:image" content="http://cdn4.infoqstatic.com/statics_s2_20160914-0333/resource/articles/android-in-depth-gradle/zh/resources/image031.png">
<meta property="og:image" content="http://cdn4.infoqstatic.com/statics_s2_20160914-0333/resource/articles/android-in-depth-gradle/zh/resources/image034.png">
<meta property="og:updated_time" content="2016-10-09T07:36:09.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gradle学习">
<meta name="twitter:description" content="Groovy基础常见语法类Groovy可以和Java一样声明和使用一个类,定义和使用一个方法。同时也提供了一个属性的默认的get和set方法
1234567891011121314151617181920212223242526272829class Person &amp;#123;	private String name;	public Person(String name) &amp;#123;		this">
<meta name="twitter:image" content="http://ww2.sinaimg.cn/large/7853084cjw1f801i9018aj20dz0420sv.jpg">
  
  
    <link rel="icon" href="/favicon.png">
  
  <!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'> -->
  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css"> -->
  <link href="//fonts.useso.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css">
  <link href='//fonts.useso.com/css?family=Open+Sans:300,600' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/style.css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <a href="/" class="logo">Kevin</a>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about/index.html">关于</a>
        
          <a class="main-nav-link" href="/atom.xml">RSS</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value=""></form>
        </div>
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
        
        
          <a id="nav-github-link" class="nav-icon" href="https://github.com/xiuweikang" title="Fork me on GitHub"></a>
        
      </nav>
    </div>
  </div>
</header>
      <nav id="mobile-nav" class="off">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about/index.html" class="mobile-nav-link">关于</a>
  
    <a href="/atom.xml" class="mobile-nav-link">RSS</a>
  
  <div id="search-form-wrap-mobile">
    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value=""></form>
  </div>
</nav>
      <div class="outer">
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/11/10/Build-Variants-Merge-Manifests/">AndroidManifests文件合并</a>
          </li>
        
          <li>
            <a href="/2016/11/07/shell学习/">shell学习</a>
          </li>
        
          <li>
            <a href="/2016/09/14/gradle学习/">gradle学习</a>
          </li>
        
          <li>
            <a href="/2016/09/01/工具类交流/">工具类交流</a>
          </li>
        
          <li>
            <a href="/2016/08/03/View基础相关/">View基础相关</a>
          </li>
        
          <li>
            <a href="/2016/08/03/Android动画详解/">Android动画详解</a>
          </li>
        
          <li>
            <a href="/2016/07/26/View的measure、layout、draw过程/">View的measure、layout、draw过程</a>
          </li>
        
          <li>
            <a href="/2016/07/08/effective-java学习笔记/">effective java学习笔记</a>
          </li>
        
          <li>
            <a href="/2016/05/15/git笔记/">git笔记</a>
          </li>
        
          <li>
            <a href="/2016/03/17/Retrofit分享/">Retrofit分享</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Gradle/" style="font-size: 10px;">Gradle</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Shell/" style="font-size: 10px;">Shell</a> <a href="/tags/TCP-IP/" style="font-size: 18.33px;">TCP/IP</a> <a href="/tags/java/" style="font-size: 13.33px;">java</a> <a href="/tags/数据结构/" style="font-size: 16.67px;">数据结构</a> <a href="/tags/源码解析/" style="font-size: 10px;">源码解析</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a> <a href="/tags/设计模式/" style="font-size: 11.67px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">links</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://my.csdn.net/jiaomingliang">亮亮的博客</a>
          </li>
        
          <li>
            <a href="http://cheduzi.wang">二哥的博客</a>
          </li>
        
          <li>
            <a href="http://blog.csdn.net/guolin_blog">郭神的博客</a>
          </li>
        
          <li>
            <a href="http://http://blog.csdn.net/singwhatiwanna">任玉刚的博客</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
        <section id="main"><article id="post-gradle学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/14/gradle学习/" class="article-date">
  <time datetime="2016-09-14T03:22:54.000Z" itemprop="datePublished">9月 14 2016</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      gradle学习
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Groovy基础"><a href="#Groovy基础" class="headerlink" title="Groovy基础"></a>Groovy基础</h2><h3 id="常见语法"><a href="#常见语法" class="headerlink" title="常见语法"></a>常见语法</h3><h4 id="类"><a href="#类" class="headerlink" title="类"></a>类</h4><p>Groovy可以和Java一样声明和使用一个类,定义和使用一个方法。同时也提供了一个属性的默认的get和set方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function">String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> name;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">def person = <span class="keyword">new</span> Person(<span class="string">"xiuweikang"</span>);</div><div class="line">print person.<span class="function">name</span></div><div class="line"></div><div class="line">String <span class="title">getPersonName</span><span class="params">(Person person)</span> &#123;</div><div class="line">	<span class="keyword">return</span> person.name</div><div class="line">&#125;</div><div class="line"><span class="function">println <span class="title">getPersonName</span><span class="params">(person)</span></span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 默认get、set</span></div><div class="line">class Person &#123;</div><div class="line">	String name;</div><div class="line">&#125;</div><div class="line"></div><div class="line">def person = <span class="keyword">new</span> Person()</div><div class="line">person.setName(<span class="string">"xiuweikang"</span>)</div><div class="line">print person.getName()</div></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><p>Grooy存在两种字符串<code>java.lang.String</code> 和<code>groovy.lang.GString</code>,其中单引号和三重单引号都是<code>java.lang.String</code>类型的，不支持占位符插值操作。双引号如果不包含占位符则是<code>java.lang.String</code>，如果有则是<code>groovy.lang.GString</code>。占位符可以用${}或者$来表示，前者主要用于一般替代字符串或者表达式，后者用于替代A.B这样形式的，但是无法对A.B()做出替换,只能通过${}</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">	String name;</div><div class="line">&#125;</div><div class="line"></div><div class="line">def person = <span class="keyword">new</span> Person()</div><div class="line">person.setName(<span class="string">"xiuweikang"</span>)</div><div class="line">def name = <span class="string">"xiuweikang"</span></div><div class="line">println person.name</div><div class="line">println <span class="string">"his name is $name"</span></div><div class="line">println <span class="string">"his name is $&#123;name&#125;"</span></div><div class="line">println <span class="string">"his name is $person.name"</span></div><div class="line">println <span class="string">"his name is $&#123;person.name&#125;"</span></div><div class="line">println <span class="string">"his name is $&#123;person.getName()&#125;"</span></div><div class="line">println <span class="string">"his name is $persion.getName()"</span><span class="comment">//  wrong</span></div></pre></td></tr></table></figure>
<h4 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h4><h5 id="Range"><a href="#Range" class="headerlink" title="Range"></a>Range</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">def x = <span class="number">1</span>..<span class="number">10</span></div><div class="line">println x</div><div class="line">println x.contains(<span class="number">5</span>)</div><div class="line">println x.size()</div><div class="line">println x.from</div><div class="line">println x.to</div><div class="line">println x.reverse()</div></pre></td></tr></table></figure>
<h5 id="List"><a href="#List" class="headerlink" title="List"></a>List</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">def list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line"><span class="keyword">assert</span> list <span class="keyword">instanceof</span> java.util.ArrayList</div><div class="line"></div><div class="line">def alist = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]as LinkedList</div><div class="line"><span class="keyword">assert</span> alist <span class="keyword">instanceof</span> java.util.LinkedList</div></pre></td></tr></table></figure>
<h5 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">def colors = [red: <span class="string">'#FF0000'</span>, green: <span class="string">'#00FF00'</span>, blue: <span class="string">'#0000FF'</span>]</div><div class="line">println colors[<span class="string">'red'</span>]</div></pre></td></tr></table></figure>
<h4 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">def list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</div><div class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; list.size();i++) &#123;</div><div class="line">	println i</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span>(i in list) &#123;</div><div class="line">	println i</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">switch</span>(<span class="number">1</span>) &#123;</div><div class="line">	<span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">		println <span class="number">1</span></div><div class="line">		<span class="keyword">break</span></div><div class="line">	<span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	<span class="keyword">default</span>:</div><div class="line">		<span class="keyword">break</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">def a = <span class="number">0</span>;</div><div class="line"><span class="keyword">while</span>(a++ &lt; <span class="number">10</span>) &#123;</div><div class="line">	println a</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="闭包-Closure"><a href="#闭包-Closure" class="headerlink" title="闭包(Closure)"></a>闭包(Closure)</h3><p>闭包是一个被包起来的代码块对象，它的行为有点像方法，可以传参数进去然后返回一个值，它也是一个普通的对象，你可以对它持有一个引用。也可以用作方法参数的代码块，Groovy的闭包更象是一个代码块或者方法指针，代码在某处被定义然后在其后的调用处执行。</p>
<h4 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h4><blockquote>
<p>{[closureParameters -&gt;] statements}</p>
</blockquote>
<p>前面的closureParameters是参数列表，类似于方法的参数列表。后面的则是代码块了。默认是存在一个参数it。如果你想声明一个不接受任何参数的闭包，且必须限定为没有参数的调用，那么你必须将它声明为一个空的参数列表。</p>
<p>闭包的调用方式有两种:</p>
<ul>
<li>闭包对象.call(参数)</li>
<li>闭包对象(参数)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;item++&#125;</div><div class="line">&#123;-&gt; print it&#125; <span class="comment">//隐含参数it</span></div><div class="line">&#123;it -&gt; print it&#125;<span class="comment">//使用明确的参数it</span></div><div class="line">&#123;String x, <span class="keyword">int</span> y -&gt; print x, print y&#125;</div></pre></td></tr></table></figure>
<ul>
<li>当看到{}的时候等同于：new Closure(){}</li>
<li>closure总是有返回值的，如果没有写return，则返回最后一行代码的左值，如果没有值，则是null</li>
<li>当闭包作为闭包或方法的最后一个参数时我们可以将闭包从参数圆括号中提取出来接在最后，如果闭包是唯一的一个参数(方法调用时都可以省略括号)，则方法参数所在的圆括号也可以省略；对于有多个闭包参数的，只要是在参数声明最后的，均可以按上述方式省略。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function">def <span class="title">debugClosure</span><span class="params">(<span class="keyword">int</span> num, String str,Closure closure)</span></span>&#123;  </div><div class="line">	closure()</div><div class="line">&#125;  </div><div class="line"></div><div class="line">debugClosure(<span class="number">1</span>, <span class="string">"groovy"</span>)&#123;  </div><div class="line">   println<span class="string">"hello groovy!"</span>  </div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function">def <span class="title">debugClosure</span><span class="params">(Closure closure)</span></span>&#123;  </div><div class="line">	closure()</div><div class="line">&#125;  </div><div class="line"></div><div class="line">debugClosure()&#123;  </div><div class="line">   println<span class="string">"hello groovy!"</span>  </div><div class="line">&#125;</div><div class="line">debugClosure&#123;  </div><div class="line">   println<span class="string">"hello groovy!"</span>  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Groovy支持.&amp;方法指针操作符，因为闭包可以被作为一个方法的参数，如果想让一个方法作为另一个方法的参数则可以将一个方法当成一个闭包作为另一个方法的参数。如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> x + y</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">A a = <span class="keyword">new</span> A();</div><div class="line">Closure cAdd = a.&amp;add;</div><div class="line"><span class="function">print <span class="title">cAdd</span><span class="params">(<span class="number">1</span>,<span class="number">2</span>)</span></span></div></pre></td></tr></table></figure></p>
<h5 id="Closure-delegate"><a href="#Closure-delegate" class="headerlink" title="Closure delegate"></a>Closure delegate</h5><p>每个闭包都有一个代理对象，在闭包上未找到的属性和方法都会转给代理对象。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDelegate</span> </span>&#123;</div><div class="line">    <span class="function">def <span class="title">func</span><span class="params">()</span> </span>&#123;</div><div class="line">        println <span class="string">'func'</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">Closure c = &#123;</div><div class="line">    func();</div><div class="line">&#125;</div><div class="line"></div><div class="line">c.delegate = <span class="keyword">new</span> MyDelegate()</div><div class="line">c.call()</div></pre></td></tr></table></figure></p>
<p>例如在build.gradle中，常会使用dependencies语句块。<br>// build.gradle</p>
<p>dependencies {<br>    compile ‘xxx:xxx:1.0’<br>    testCompile ‘xxx:xxx:1.0’<br>}<br>dependencies是Project对象中定义的DSL方法，后面的大括号是其接受的闭包参数；这里Groovy的括号可以省略；<br>传进来的闭包的delegate被设置成DependencyHandler，因此当其调用compile方法时，内部其实是调用的DependencyHandler中的compile/testCompile方法。</p>
<h2 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h2><h3 id="gradle基础"><a href="#gradle基础" class="headerlink" title="gradle基础"></a>gradle基础</h3><p>在Gradle中每个待编译的工程都是一个Project，每一个Project在构建的时候都包含一系列的Task，比如一个Android APK的编译可能包含：Java源码编译Task、资源编译Task、JNI编译Task、lint检查Task、打包生成APK的Task、签名Task等,这些Task大部分是由插件定义的，而Gradle则只是一个框架，它只负责定义流程和规则。而相应的工作都由相应的插件支持，比如编译Java的有相应的Java插件，Andrid的有Android插件。</p>
<p>Android中的每一个Library和每一个App都是单独的一个Project，而每个Project下都会存在一个build.gradle文件（该文件名是默认的，当gradle执行命令时会在当前目录下找到build.gradle文件），这个文件就是该Project的编译脚本。当一个目录下存在多个Project，我们构建时，需要cd到每个Project下然后执行相应的grdle命令，如果我想在根目录下直接执行gradle命令就让所有的Project都build的话就需要在根目录下添加setting.gradle，它来告诉gradle这个目录下存在多少个Project，然后都执行每个Project的build.gradle，同时根目录下也可以有build.gradle文件，它可以配置其他子Project，比如为子Project添加一些共通的属性等。</p>
<h3 id="gradle命令"><a href="#gradle命令" class="headerlink" title="gradle命令"></a>gradle命令</h3><p><code>gradle projects</code> 查看一个multi Projects下面包含多少个子Project<br><img src="http://ww2.sinaimg.cn/large/7853084cjw1f801i9018aj20dz0420sv.jpg" alt="14:34:48.jpg"><br>相应的settings.gradle <code>include &#39;:app&#39;, &#39;:aaa&#39;, &#39;:mylibrary&#39;</code></p>
<p><code>gradle tasks</code> 查看task信息，也可以<code>gradle project-path:tasks</code>查看某个Projects下的tasks<br><img src="http://ww1.sinaimg.cn/large/7853084cjw1f801m75ijyj20la0foacw.jpg" alt="14:39:09.jpg"><br><img src="http://ww2.sinaimg.cn/large/7853084cjw1f801mvhf8qj20pq0gvq6w.jpg" alt="14:39:47.jpg"><br><img src="http://ww2.sinaimg.cn/large/7853084cjw1f801o7sq3aj20es05mwet.jpg" alt="14:41:04.jpg"></p>
<p><code>gradle task-name</code>执行相应的task<br>比如在某个project下写一个task<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">task hello &#123;</div><div class="line">    doLast &#123;</div><div class="line">        println <span class="string">'Hello world!'</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>gradle hello</code> 则会执行hello task。上面的图包括了好多的Task,比如：</p>
<ul>
<li>gradle clean是执行清理任务，和make clean类似。</li>
<li>gradle properites用来查看所有属性信息。</li>
</ul>
<p>注意：Task之间是存在依赖的，比如TaskA依赖TaskB则在执行TaskA时，TaskB首先需要被执行。</p>
<h3 id="gradle工作流程"><a href="#gradle工作流程" class="headerlink" title="gradle工作流程"></a>gradle工作流程</h3><p><img src="http://cdn4.infoqstatic.com/statics_s2_20160914-0333/resource/articles/android-in-depth-gradle/zh/resources/image028.png" alt=""><br>Gradle分为三个阶段：</p>
<ul>
<li>初始化阶段（Initiliazation）： 对multi-project而言就是执行setting.gradle，在构建时会为当前项目创建一个Settings类型的实例，如果当前项目存在settings.gradle文件，则通过该文件配置Settings实例。</li>
<li>配置阶段(Configuration): 在这个阶段会解析每个project的build.gradle，它会建立一个有向图来描述Task之间的依赖关系。</li>
<li>执行阶段（Execution）：在这个阶段会对gradle命令指定的task及其依赖task进行执行.</li>
</ul>
<p>最后，关于Gradle的工作流程，你只要记住：</p>
<ul>
<li>Gradle有一个初始化流程，这个时候settings.gradle会执行。</li>
<li>在配置阶段，每个Project都会被解析，其内部的任务也会被添加到一个有向图里，用于解决执行过程中的依赖关系。</li>
<li>然后才是执行阶段。你在gradle xxx中指定什么任务，gradle就会将这个xxx任务链上的所有任务全部按依赖顺序执行一遍！</li>
</ul>
<h3 id="gradle实例详解"><a href="#gradle实例详解" class="headerlink" title="gradle实例详解"></a>gradle实例详解</h3><p>Gradle总共有三种对象，分别对应三种不同的脚本文件，三种对象为gradle脚本的代理对象(delegate object)，我们可以在脚本中使用代理对象的属性和方法：</p>
<ul>
<li>Gradle对象：当我们执行gradle …的时候，gradle会从默认的脚本中构造出一个Gradle对象，主要用于为接下来的构造工作做一些准备工作。如果要写这种初始化脚本应该按照规则放在下面的目录下,我们一般很少去定制这个脚本：<br><img src="http://ww3.sinaimg.cn/large/7853084cjw1f809gxpn6mj20dj02h0t0.jpg" alt="19:10:54.jpg"></li>
<li>Project对象：每一个build.gradle对象都会最终转换成一个Project对象。</li>
<li>Settingds对象：每一个settings.gradle对象最终都会转换成Settings对象。</li>
</ul>
<p>具体流程：</p>
<ol>
<li>为当前项目创建一个Settings类型的实例。</li>
<li>如果当前项目存在settings.gradle文件，则通过该文件配置刚才创建的Settings实例。</li>
<li>通过Settings实例的配置创建项目层级结构的Project对象实例。</li>
<li>最后通过上面创建的项目层级结构Project对象实例去执行每个Project对应的build.gradle脚本。</li>
</ol>
<h4 id="Gradle对象"><a href="#Gradle对象" class="headerlink" title="Gradle对象"></a>Gradle对象</h4><p>Gradle对象在整个执行过程中只存在一个，同时包含了很多的属性和方法，我们都可以在脚本文件中直接调用，比如：<br><img src="http://cdn4.infoqstatic.com/statics_s2_20160914-0333/resource/articles/android-in-depth-gradle/zh/resources/image031.png" alt=""><br>在根目录下的build.gradle和setting.gradle中设置下面的，可以看到gradle对象是同一个<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">////在settings.gradle中，则输出"In settings,gradle id is"</span></div><div class="line">println <span class="string">"In gradle, gradle id is "</span> +gradle.hashCode()</div><div class="line">println <span class="string">"Home Dir:"</span> + gradle.gradleHomeDir</div><div class="line">println <span class="string">"User Home Dir:"</span> + gradle.gradleUserHomeDir</div><div class="line">println <span class="string">"Parent: "</span> + gradle.parent</div></pre></td></tr></table></figure></p>
<h4 id="Project对象"><a href="#Project对象" class="headerlink" title="Project对象"></a>Project对象</h4><h5 id="加载插件"><a href="#加载插件" class="headerlink" title="加载插件"></a>加载插件</h5><p>Project对象中包含自己的属性和方法，同时每个Project会包含很多Task，而这些Task往往是由插件决定的：</p>
<p>加载插件可以通过Project中定义的apply方法，参数是一个map，key包含三种，如下图：<br><img src="http://cdn4.infoqstatic.com/statics_s2_20160914-0333/resource/articles/android-in-depth-gradle/zh/resources/image034.png" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">apply plugin: <span class="string">'com.android.library'</span>    &lt;==如果是编译Library，则加载此插件</div><div class="line">apply plugin: <span class="string">'com.android.application'</span>  &lt;==如果是编译Android APP，则加载此插件</div><div class="line"><span class="comment">//也可以加载某个目录下的gradle文件，比如加载一个共通方法的gradle</span></div><div class="line">apply from: rootProject.getRootDir().getAbsolutePath() + <span class="string">"/utils.gradle"</span></div></pre></td></tr></table></figure>
<h5 id="设置属性"><a href="#设置属性" class="headerlink" title="设置属性"></a>设置属性</h5><p>有些时候我们需要配置一些共通的属性方便在不同的Project中调用，这样在之后的更改中只更改配置文件中的共通属性就可以了，不需要每个Project都改。<br>Gradle提供了一种名为extra property的方法。extra property是额外属性的意思，在第一次定义该属性的时候需要通过ext前缀来标示它是一个额外的属性。定义好之后，后面的存取就不需要ext前缀了。ext属性支持Project和Gradle对象。即Project和Gradle对象都可以设置ext属性</p>
<p>举个例子：在setting.gradle中设置一些属性，在其他project时取到：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function">def <span class="title">getSDKPath</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="comment">//属性值从local.properites中读取</span></div><div class="line">    Properties properties = <span class="keyword">new</span> Properties()</div><div class="line">    File propertyFile = <span class="keyword">new</span> File(rootDir.getAbsolutePath() +<span class="string">"/local.properties"</span>)</div><div class="line">    properties.load(propertyFile.newDataInputStream())</div><div class="line">    <span class="comment">//gradle就是gradle对象。它默认是Settings和Project的成员变量。可直接获取</span></div><div class="line">    <span class="comment">//ext前缀，表明操作的是外置属性。api是一个新的属性名。前面说过，只在</span></div><div class="line">    <span class="comment">//第一次定义或者设置它的时候需要ext前缀</span></div><div class="line">    gradle.ext.sdkDir =properties.getProperty(<span class="string">'sdk.dir'</span>)</div><div class="line">    println gradle.sdkDir  <span class="comment">//再次存取api的时候，就不需要ext前缀了</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//可以在其他的project中调用，因为整个执行过程中的gradle对象是同一个。</span></div><div class="line">task projectTask &lt;&lt;&#123;</div><div class="line">    println gradle.sdkDir</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>

  
  
</article>

  
<section id="comments">
    <!-- 多说分享框 -->
    <div class="ds-share flat" data-thread-key="/2016/09/14/gradle学习/" data-title="gradle学习" data-images="https://raw.githubusercontent.com/Hankiya/LoveOnline/master/Rich%20Format%20Vertical.png" data-content="gradle学习" data-url="//2016/09/14/gradle学习/">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">

      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
   </div>
    <!-- 多说评论框 start -->
   	<div class="ds-thread" data-thread-key="/2016/09/14/gradle学习/" data-title="gradle学习" data-url="//2016/09/14/gradle学习/"></div>
   <!-- 多说评论框 end -->
   <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
   <script type="text/javascript">
   var duoshuoQuery = {short_name:"hanks-zyh"};
   	(function() {
   		var ds = document.createElement('script');
   		ds.type = 'text/javascript';ds.async = true;
   		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
   		ds.charset = 'UTF-8';
   		(document.getElementsByTagName('head')[0]
   		 || document.getElementsByTagName('body')[0]).appendChild(ds);
   	})();
   	</script>
   <!-- 多说公共JS代码 end -->
</section>

</section>
      </div>
      <footer id="footer">
  
  <div class="outer footer_center">
    <div id="footer-info" class="inner">
      &copy; 2016 Kevin<br>
      彼此当年少，莫负好时光
  </br>
    </div>
  </div>
</footer>

    </div>
    

<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollLoading.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>